var kronosAppFrontend=function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}var o=n(1),i=r(o),a=n(2),s=r(a),u=n(3),c=r(u),l=n(17),h=r(l),f=n(18),d=r(f),p=n(20),_=r(p),v=n(21),m=r(v),g=n(22),y=r(g),b=n(12),w=r(b),k=n(23),E=r(k),x=n(13),S=r(x);e.exports={Application:c.default,View:h.default,EditView:d.default,Router:y.default,sprintf:s.default,DateHelper:_.default,removeDiacritics:m.default,jQueryExtend:i.default,BrowserDetect:w.default,AsyncTask:E.default,FetchService:S.default,FetchAbortError:x.FetchAbortError,FetchResponseDataError:x.FetchResponseDataError,externals:{jquery:"jQuery","raven-js":"raven-js","whatwg-fetch":"whatwg-fetch"}}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return{alternateText:function(e,t){return this.text(e&&""!==e?e:t),this},numberText:function(e){var n=t.formatNumber(e);return this.text(""===n?"0":n),this},moneyText:function(e){return this.text(t.formatMoney(e)),this},dateText:function(e){return this.text(t.date.format(e)),this},durationVal:function(e){var n=void 0;if(isFinite(e)){var r=e<0?"-":"",o=Math.floor(Math.abs(e)/12),i=Math.abs(e)-12*o;n=r+(0===o?"":(1===o?t._("YEARD").replace("%{years}",o):t._("YEARSD").replace("%{years}",o))+" ")+(0===i?"":1===i?t._("MONTHD").replace("%{months}",i):t._("MONTHSD").replace("%{months}",i))}else n="";return this.val(n),this},booleanText:function(e){return e="YES"===e?t._("YES"):"NO"===e?t._("NO"):"-",this.text(e),this},dateVal:function(e){return this.val(t.date.format(e,"input")),this},safeClick:function(e){return this.click(function(n){if(this.__clicked)t.debug&&console.debug("catched double click");else{this.__clicked=!0,e.call(this,n);var r=this;setTimeout(function(){r.__clicked=!1},500)}}),this},numberVal:function(n,r){if(arguments.length>0)return e(this).val(t.formatNumber(n,r));var o=t.parseFloat(this.val());return e(this).hasClass("positive")&&e(this).hasClass("number")&&o<0?0:o},number:function(n){return e(this).each(function(){e(this).addClass("number"),e(this).val(t.formatNumber(e(this).val(),n)),e(this).blur(function(){e(this).val(t.formatNumber(e(this).val(),n))})})},moneyVal:function(n,r){if(arguments.length>0)return e(this).hasClass("money")?(e(this).data("val",t.parseFloat(n.replace("$",""))),e(this).val(t.formatMoney(n,r))):e(this).val(t.formatMoney(n,r));if(e(this).hasClass("money")){var o=e(this).data("val");return e(this).hasClass("positive")&&o<0?0:o}return t.parseFloat(e(this).val().replace("$",""))},money:function(n){return e(this).each(function(){var r=e(this);r.addClass("money"),r.focus(function(){return e(this).val(e(this).data("val")),this}),e(this).click(function(){e(this).select()}),e(this).blur(function(){var r=void 0,o=e(this).val();return n&&n.canBeNull&&(""===o||null===o)?r="":(r=t.parseFloat(o.replace("$","")),n&&n.true_precision&&(r=n.rounded?Math.round(r*Math.pow(10,n.true_precision))/Math.pow(10,n.true_precision):Math.floor(r*Math.pow(10,n.true_precision))/Math.pow(10,n.true_precision))),e(this).data("val",r),e(this).val(t.formatMoney(r,n)),this}),""!==r.val()&&r.blur()})},percentVal:function(n,r){if(arguments.length>0)return e(this).val(t.formatPercent(n,r));var o=t.parseFloat(this.val().replace("%",""));return e(this).hasClass("positive")&&e(this).hasClass("percent")&&o<0?0:o},percent:function(n){return e(this).each(function(){e(this).addClass("percent"),e(this).val(t.formatPercent(e(this).val(),n)),e(this).blur(function(){e(this).val(t.formatPercent(e(this).val(),n))})})},SIN:function(){return e(this).each(function(){e(this).val(t.formatSIN(e(this).val())),e(this).blur(function(){this.value=t.formatSIN(e(this).val())})})},datepickerInput:function(t){return e(this).each(function(){var n=e(this),r=n.next(".btn.calendar");if(0===n.next(".btn.calendar").length&&(r=$('<a href="javascript:void(0);" class="btn calendar" tabindex=-1><span class="icon"></span></a>')),n.after(r),$.browser.msie&&n.before($('<div class="clear"></div>')),n.width()&&n.css("width","-="+r.outerWidth(!0)).attr("autocomplete","off"),"undefined"!=typeof t){var o=$.extend({dateFormat:"yy-mm-dd",onClose:function(t){try{var n=$.datepicker.parseDate("yymmdd",t);e(this).val($.datepicker.formatDate("yy-mm-dd",n))}catch(n){e(this).val(t)}}},t);n.datepicker(o)}else n.datepicker({dateFormat:"yy-mm-dd",onClose:function(t){try{var n=$.datepicker.parseDate("yymmdd",t);e(this).val($.datepicker.formatDate("yy-mm-dd",n))}catch(n){e(this).val(t)}}});r.bind("click",function(e){e.preventDefault(),n.datepicker("widget").is(":hidden")&&n.datepicker("show")})})},hint:function(t,n){var r=Math.max(parseInt(n,10),200);return e(this).wrap('<span class="hinted"></span>').after('<span class="hint" style="width: '+r+"px; right: -"+(r+50)+'px;">'+t+'<span class="hint-pointer sprite">&nbsp;</span></span>').focus(function(){var e=this;e._focus_timeout=setTimeout(function(){$(e).next(".hint").fadeIn()},1e3)}).blur(function(){this._focus_timeout&&clearTimeout(this._focus_timeout),e(this).next(".hint").fadeOut()}).keypress(function(){this._focus_timeout&&clearTimeout(this._focus_timeout),e(this).next(".hint").fadeOut()})},unhint:function(){return e(this).parent().hasClass("hinted")?(e(this).next(".hint").remove(),e(this).unwrap()):e(this).parent().find(".hinted")&&e(this).next(".hint").remove(),this},hintError:function(t,n,r){var o=void 0,i=e(this);i.combobox&&void 0!==i.combobox("instance")&&(i=i.combobox("instance").input,i.data("isCombobox",!0));var a=i;o=a.data("blur-field")?$("#"+a.data("blur-field")):a;var s=["hinted"];return i.data("is-textbox")&&(a=i.next().is(".hinted")?i.next().find(".textboxlist"):i.next(".textboxlist"),a.find(".textboxlist-bit-box-deletable").blur(function(){a.next(".hint").fadeOut()}).focus(function(){a.next(".hint").fadeIn()}).change(function(){$(a).handleHintErrorChange()})),(i.data("is-textbox")||a.hasClass("textboxlist"))&&(s.push("contain-textbox"),o=a.find(".textboxlist-bit-editable-input")),a.unhint(),a.addClass("save_warning"),a.data("no-hinted-span")||a.wrap('<span class="'+s.join(" ")+'"></span>'),a.after('<span class="hint">'+t+'<span class="hint-pointer sprite">&nbsp;</span></span>'),o.blur(function(){a.next(".hint").fadeOut()}).focus(function(){a.next(".hint").fadeIn()}).change(function(){$(a).handleHintErrorChange()}),a.data("hint",a.next(".hint")),a.setHintErrorWidth(n),a.setHintErrorPosition(),a.data("extra-hint-classes")&&a.parents(".hinted").addClass(a.data("extra-hint-classes")),a.data("hint").click(function(t){t.preventDefault(),t.stopPropagation(),e(this).fadeOut()}),r||a.data("hint").fadeIn(),a},handleHintErrorChange:function(){e(this).unhint().removeClass("save_warning")},setHintErrorWidth:function(t){var n=Math.max(parseInt(t,10),200);return e(this).next(".hint").css({width:n}),e(this)},setHintErrorPosition:function(){var t=-(parseInt(e(this).data("hint").css("width"))+50);return e(this).data("hint").css({right:t}),e(this)},signal:function(t){return t=parseInt(t),t<=0&&(t=500),e(this).each(function(){e(this).addClass("signal");var n=this;setTimeout(function(){$(n).removeClass("signal")},t)})},checkVal:function(){if(arguments.length>0){var e=!1;return"YES"!=arguments[0]&&arguments[0]!==!0||(e=!0),this.prop("checked",e),this}return this.val()},toggleDisabled:function(e,t){void 0===t&&(t=!0),e?(this.attr("disabled","disabled"),t&&this.addClass("disabled")):(this.removeAttr("disabled"),t&&this.removeClass("disabled"))},getClasses:function(){var t=[];return e(this).each(function(){var n=e(this).attr("class").split(" ");for(var r in n){var o=!1;for(var i in t)t[i]==n[r]&&(o=!0);o||t.push(n[r])}}),t}}}},function(e,t){"use strict";function n(e,t){t?e.sign="":e.sign=e.negative?"-":e.sign;var n=e.min-e.argument.length+1-e.sign.length,r=new Array(n<0?0:n).join(e.pad);return e.left?"0"==e.pad||t?e.sign+e.argument+r.replace(/0/g," "):e.sign+e.argument+r:"0"==e.pad||t?e.sign+r+e.argument:r+e.sign+e.argument}function r(){if("undefined"==typeof arguments)return null;if(arguments.length<1)return null;if("string"!=typeof arguments[0])return null;if("undefined"==typeof RegExp)return null;for(var e=arguments[0],t=new RegExp(/(%([%]|(\-)?(\+|\x20)?(0)?(\d+)?(\.(\d)?)?([bcdfosxX])))/g),r=[],o=[],a=0,s=0,u=0,c=0,l="",h=null;h=t.exec(e);)h[9]&&(a+=1),s=c,u=t.lastIndex-h[0].length,o[o.length]=e.substring(s,u),c=t.lastIndex,r[r.length]={match:h[0],left:!!h[3],sign:h[4]||"",pad:h[5]||" ",min:h[6]||0,precision:h[8],code:h[9]||"%",negative:parseInt(arguments[a])<0,argument:String(arguments[a])};if(o[o.length]=e.substring(c),0===r.length)return e;if(arguments.length-1<a)return null;h=null;for(var f=0;f<r.length;f++){var d=void 0;"%"==r[f].code?d="%":"b"==r[f].code?(r[f].argument=String(Math.abs(parseInt(r[f].argument,10)).toString(2)),d=n(r[f],!0)):"c"==r[f].code?(r[f].argument=String(String.fromCharCode(parseInt(Math.abs(parseInt(r[f].argument,10))))),d=n(r[f],!0)):"d"==r[f].code?(r[f].argument=String(Math.abs(parseInt(r[f].argument,10))),d=n(r[f])):"f"==r[f].code?(r[f].argument=String(Math.abs(parseFloat(r[f].argument,10)).toFixed(r[f].precision?r[f].precision:6)),d=n(r[f])):"o"==r[f].code?(r[f].argument=String(Math.abs(parseInt(r[f].argument,10)).toString(8)),d=n(r[f])):"s"==r[f].code?(r[f].argument=r[f].argument.substring(0,r[f].precision?r[f].precision:r[f].argument.length),d=n(r[f],!0)):"x"==r[f].code?(r[f].argument=String(Math.abs(parseInt(r[f].argument,10)).toString(16)),d=n(r[f])):"X"==r[f].code?(r[f].argument=String(Math.abs(parseInt(r[f].argument,10)).toString(16)),d=n(r[f]).toUpperCase()):d=r[f].match,l+=o[f],l+=d}return l+=o[i]}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(4),l=r(c),h=n(5),f=r(h),d=n(12),p=r(d),_=n(13),v=r(_),m=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};o(this,t);var r=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r.router=e,r.view_fetching=!1,r.debug=!1,r.sendErrors=!1,r.sendErrorsOnUnload=!1,r.silent=!1,r.trace_retirement=!1,r._errors=[],r.ajaxQueryLoading=!1,r.pingInterval=!1,r.messages=!1,r.JS_PATH="/",r.IMG_PATH="/",r.VIRTUALPATH="/",r.SESSION_KEY=!1,r._is_observing_hash=!1,r._hash_changed_while_not_observing=!0,r.hash=!1,r._history=[],r.userName="",r.cpanelUserName="",r.userVersion=0,r.menus=!1,r.views=!1,r.default_view="",r.default_goal_death="",r.default_goal_disability="",r.fna_expiration=365,r.currentView=!1,r._view_cache={},r._loadingDelay=3e3,r._loadingTimeout=0,r._view_objects={},r._messages={},r.emailRegex=/^[a-zA-Z0-9!#$%&'*+\-\/=?^_`{|}~]+(?:\.[a-zA-Z0-9!#$%&'*+\-\/=?^_`{|}~]+)*@[a-zA-Z0-9-]+(\.[a-zA-Z0-9-]+)*$/,r.currencyRegex=/^[0-9.,\s]+$/,r.percentageRegex=/^[0-9.,]+$/,r._ongoing_xhrs=[],r.unmounts=[],r.browser=n.browserDetect||new p.default(navigator.userAgent),r.fetchService=new v.default(r),r.detectedExpiredSessionTimeout=!1,r.detectedExpiredSessionGoTo=!1,r.detectedNetworkErrorTimeout=!1,r.detectedNetworkErrorGoTo=!1,r.ravenEnabled=!1,r}return a(t,e),u(t,[{key:"init",value:function(){var e=this;$(document).ajaxStart(function(){e.ajaxQueryLoading=!0}),$(document).ajaxStop(function(){e.ajaxQueryLoading=!1}),this.pingInterval&&setInterval(function(){e.ajaxQueryLoading||e.get("CPanel/View","ping","",function(){console.debug("session is still alive")},!1,function(){console.debug("got an error while doing a ping ?")})},this.pingInterval),window.onerror=function(t,n,r){return"undefined"!=typeof window.UEInfo&&(window.errors.push(arguments),window.UEInfo.run()),e._onError(t,n,r)};var t=this.onunhandledrejection.bind(this);"undefined"!=typeof PromiseRejectionEvent?window.addEventListener("unhandledrejection",t):window.onunhandledrejection=t,window.onbeforeunload=function(){return e._beforeUnload()},window.name.match(/^GUID-/)||(window.name="GUID-"+e.generateGUID()),$("#hook_confidentiality_policy,#hook_usage_policy").safeClick(function(){e.showMessage($(this).text(),e._("AVAILABLE_SOON"))}),$.ajaxSetup({beforeSend:function(t){if(!this.crossDomain){var n=e.getXSRFHeaders();$.each(n,function(e,n){t.setRequestHeader(e,n)})}}})}},{key:"onunhandledrejection",value:function(e){var t=e.reason;if(t instanceof _.FetchAbortError)return void("function"==typeof e.preventDefault&&e.preventDefault());var n=e.reason;console.warn("Unhandled promise rejection:",n&&(n.stack||n)),this.ravenEnabled&&f.default.captureException(n)}},{key:"configure",value:function(e){if(e.debug&&(this.debug=!0),e.sendError&&(this.sendErrors=!0),e.sendErrorsOnUnload&&(this.sendErrorsOnUnload=!0),e.silent&&(this.silent=!0),e.trace_retirement&&(this.trace_retirement=!0),e.jqueryui&&e.jqueryui.startingday&&(this.startingDay=e.jqueryui.startingday),this.JS_PATH=e.JS_PATH,this.IMG_PATH=e.IMG_PATH,this.VIRTUALPATH=e.VIRTUALPATH,this.SESSION_KEY=e.SESSION_KEY,this.replaced_session_key=!1,this._xsrf_cookie_name=e.xsrf_cookie_name,this._xsrf_header_name=e.xsrf_header_name,this.checkStoredSession(),!e.application_version)throw this._throw("Applicaiton version not defined in configuration",!0);if(this._application_version=e.application_version,"object"!==s(e.user))throw"No user info in application configuration";e&&e.sentry&&(f.default.config("https://"+e.sentry.key+"@app.getsentry.com/"+e.sentry.project,{release:e.application_version}),f.default.setTagsContext({version:e.application_version}),f.default.setUserContext({email:e.user.email,id:e.user.id,name:e.user.name}),f.default.setExtraContext({transaction:e.kronos_transaction_id}),f.default.install(),this.ravenEnabled=!0),this._configure(e),this.setUserConfig(e.user);for(var t in this.views){var n=this.views[t];"1"===n.default&&(this.default_view=t)}}},{key:"_configure",value:function(){}},{key:"getApplicationVersion",value:function(){return this._application_version}},{key:"getXSRFToken",value:function(){if(this._xsrf_cookie_name){var e=$.cookie(this._xsrf_cookie_name);return"undefined"!=typeof e&&e}return!1}},{key:"getXSRFHeaders",value:function(){var e=this,t={},n=e.getXSRFToken();return e._xsrf_header_name&&(t[e._xsrf_header_name]=n),t}},{key:"getXSRFData",value:function(){var e=this,t={},n=e.getXSRFToken();return e._xsrf_cookie_name&&(t[e._xsrf_cookie_name]=n),t}},{key:"setUserConfig",value:function(e){var t=this;t.userVersion=e.version,t.userName=e.name,t.userEmail=e.email,t.userType=e.type,t.menus=e.menus,t.views=e.views,t.userIsAssumed=e.assumed,t.userIsCpanelAssumed=e.cpanel_assumed,t.cpanelUserName=e.cpanel_user_name,t.setLocale(e.locale),t._setUserConfig(e),this._buildHeader()}},{key:"_setUserConfig",value:function(){}},{key:"setLocale",value:function(e){if(this.locale!=e){this.locale=e,e.indexOf("fr")!=-1?this.lang="fr":this.lang="en",moment.locale(this.lang),this._messages[this.lang]||$.ajax({url:this.JS_PATH+this.lang+".js",data:!1,dataType:"script",async:!1,cache:!0});var t=$.extend($.datepicker.regional[this.lang],{dateFormat:"yy-mm-dd",changeMonth:!0,changeYear:!0,gotoCurrent:!0,yearRange:"-90:+10"});this.startingDay&&(t.firstDay=this.startingDay),$.datepicker.setDefaults(t),$(".localeBound").trigger("setLocaleEvent"),this._setLocale(e)}}},{key:"_",value:function(e){if(!this._messages[this.lang])return e;var t=this._messages[this.lang][e];return t?t:e}},{key:"start",value:function(){this.hook();var e=this;window.onhashchange=function(){e._is_observing_hash?e._checkHash():e._hash_changed_while_not_observing=!0},this._observe()}},{key:"hook",value:function(){var e=this;"function"==typeof this._hook&&this._hook(),$(".hook_question_comments").click(function(){e.showQuestionCommentDialog()})}},{key:"loadMessages",value:function(e,t){this._messages[e]=t}},{key:"_beforeUnload",value:function(e){(this.sendErrors||this.sendErrorsOnUnload)&&this._sendErrors(),this.abortOngoingXHR()}},{key:"_throw",value:function(e,t){return $.toJSON({message:e,type:t?"fatal":"error"})}},{key:"_onError",value:function(e,t,n){this.debug&&console.debug(e+" ("+t+":"+n+")");try{var r=$.secureEvalJSON(e.replace("uncaught exception: ",""));"fatal"==r.type&&this._showFatalError(r.message),e=r.message,r=null}catch(e){}return this.sendErrors&&(this._errors.push({description:e,page:t,line:n}),this._errors.length>10&&this._sendErrors()),this.silent}},{key:"_sendErrors",value:function(){var e=this;if(this._errors.length>0){for(var t=[],n=0;n<this._errors.length;n++)for(var r in this._errors[n])t.push("error["+n+"]["+r+"]="+encodeURIComponent(this._errors[n][r]));$.ajax({async:!1,url:"index.php?k="+e.SESSION_KEY+"&action=error&"+t.join("&")}),delete this._errors,this._errors=[]}}},{key:"_showNavigationError",value:function(){var e=this;e.showModalDialog("<h2>"+e._("NAVIGATION_ERROR")+"</h2>\t\t\t\t\t\t\t\t\t\t\t<p>\t\t\t\t\t\t\t\t\t\t\t\t<strong>"+e._("INVALID_PAGE_REQUEST")+'</strong>\t\t\t\t\t\t\t\t\t\t\t\t<br />\t\t\t\t\t\t\t\t\t\t\t</p>\t\t\t\t\t\t\t\t\t\t\t<p class="submit">\t\t\t\t\t\t\t\t\t\t\t\t<input type="submit" id="hook_create_error_close" value="'+e._("OK")+'" />\t\t\t\t\t\t\t\t\t\t\t</p>',"fast",function(){$("#hook_create_error_close").safeClick(function(){e.hideModalDialog("fast"),e._stopObservation(),e.hash=e.stepBack(),e.addHistory(e.hash),e._observe()})})}},{key:"_showFatalError",value:function(e){var t=this;this.showModalDialog("<h2>"+t._("ERROR")+"</h2>\t\t\t\t\t\t\t<p>\t\t\t\t\t\t\t\t<strong>"+t._("FATAL_ERROR_OCCURED")+'</strong>\t\t\t\t\t\t\t\t<br />\t\t\t\t\t\tinit\t</p>\t\t\t\t\t\t\t<p class="submit">\t\t\t\t\t\t\t\t'+t._("FATAL_ERROR__YOU_CAN")+' <a id="fatal-error-reload" href="javascript:void(0);">'+t._("FATAL_ERROR__RELOAD_PAGE")+"</a> "+t._("OR")+' <a id="fatal-error-stepback" href="javascript:void(0);">'+t._("FATAL_ERROR__GO_BACK")+"</a>\t\t\t\t\t\t\t</p>","fast",function(){$("#fatal-error-reload").click(function(){t._hideFatalError("reload")}),$("#fatal-error-stepback").click(function(){t._hideFatalError("stepback")}),t._errors.push({description:e,page:"Application.js",line:0})})}},{key:"_hideFatalError",value:function(e){var t=this;this.hideModalDialog("fast",function(){t.hideOverlay(),$("#fatal_error").remove(),"reload"==e?location.reload():"stepback"==e&&t.forceStepBack()})}},{key:"_observe",value:function(){this.debug&&console.debug("Observing hash from now on"),this._is_observing_hash=!0,this._hash_changed_while_not_observing&&(this._hash_changed_while_not_observing=!1,this._checkHash())}},{key:"_stopObservation",value:function(){this.debug&&console.debug("Stopped hash observation"),this._is_observing_hash=!1}},{key:"_checkHash",value:function(){var e=this,t=void 0;if(!this.view_fetching&&this.hash!==location.hash){if(this.debug&&console.debug("Hash changed"),this.hash=location.hash,!this.hash||"#"===this.hash)return this.goTo(this.default_view),!1;var n=this.hash.substring(1).split("&");t=n.shift();var r=t.indexOf("/");if(r>0){var o=t.indexOf("/",r+1);o>0&&(r=o,t=t.substring(0,r))}n=null,""!==t&&null!==t||(t=this.default_view);var i={fetch:!0,cancel:!1},a=Promise.resolve(i);this.currentView&&(a=a.then(function(n){return e._getViewObject(e.currentView).then(function(r){return t===e.currentView&&r.onHashChange(e.hash)?(n.fetch=!1,n):e.currentView?r.close().then(function(t){return t.cancel?(e.debug&&console.debug("View coulnd't close"),e._stopObservation(),e.hash=e.stepBack(),e._observe(),n.cancel=!0,n):(e.emit("viewClose",r),n)}):n}).catch(function(){return n})})),a.then(function(n){return!n.cancel&&(e._force_clear?(e.addHistory(e.hash),e._force_clear=!1):e._detectStepBack(e.hash)||e.addHistory(e.hash),void(n.fetch&&(e.hideModalDialogNow(),e._selectViewMenu(t),e._fetchView(t))))})}}},{key:"goTo",value:function(e,t){this.debug&&console.debug('Go To "'+e+'"'),t&&(this._force_clear=!0),location.hash=e}},{key:"goToNoTriggerHashChange",value:function(e){this._stopObservation(),this.goTo(e),this._hash_changed_while_not_observing=!1,this.hash=e,this._observe()}},{key:"navigateBackTo",value:function(e){this._history.pop(),this.replace(e)}},{key:"replace",value:function(e){return e||(e=""),"#"!=e.charAt(0)&&(e="#"+e),this.isOpera()?void location.replace(location.protocol+"//"+location.hostname+location.pathname+e):void location.replace(e)}},{key:"forceGoTo",value:function(e,t){this._stopObservation(),this.debug&&console.debug('Force Go To "'+e+'"'),t&&(this._force_clear=!0),location.hash=e,location.reload()}},{key:"parseHash",value:function(e){var t={view:"",params:{}},n=e.split("&");t.view=n.shift().substr(1);for(var r=0;r<n.length;r++){var o=n[r].split("="),i=o.shift();t.params[i]=decodeURIComponent(o.join("="))}return t}},{key:"reload",value:function(e,t){t&&this._setViewCache(this.currentView,!1,!1),this._fetchView(this.currentView,e)}},{key:"_onFetchView",value:function(e){}},{key:"_onLoadView",value:function(e,t,n){}},{key:"_fetchView",value:function(e,t){var n=this;this.currentView=e;var r=this;this._getViewObject(this.currentView).then(function(o){r._hideLoading(),r.abortOngoingXHR();var i=n._isViewCached(e);i&&n.debug&&console.debug('View "'+e+'" is in cache ('+n.lang+")"),n.view_fetching=!0,r._onFetchView(o);var a=o.parseHash(location.hash);for(var s in a.params)a[s]=a.params[s];if(delete a.params,t&&$.isPlainObject(t))for(s in t)a[s]=t[s];a.k=r.SESSION_KEY,a.view=r.currentView,a.cmd="view",a.cached=i,a.version=n.getApplicationVersion(),a.uv=r.userVersion,n.replaced_session_key&&(a.rk=n.replaced_session_key,n.replaced_session_key=!1);var u=$.param(a);$.ajax({url:"index.php?"+u,type:"POST",data:{context:r.getContext()},dataType:"json",headers:r.getXSRFHeaders(),success:function(n){if(r.view_fetching=!1,r._hideLoading(),n.redirect)return r.goTo(n.view),!1;if("error"==n.status){var i=n.data;return 600==i.code?r._showFatalError('An error occured server side while fetching view data "'+e+'" (600)'):601==i.code||602==i.code?r._showNavigationError():r._showFatalError('An unknown error was sent from server while fetching view data "'+e+'" ('+i.error+")"),!1}r._onLoadView(o,n.data,t),r._loadView(n.data,t)},error:function(e){function t(t,n,r){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(t,n,o){var i=this;r.view_fetching=!1,r._hideLoading(),r.validateXHR(t).then(function(t){t&&(i.debug&&(console.debug("AJAX query error"),console.debug(n),console.debug(o)),r._showFatalError('An error occured while fetching view data "'+e+'" ('+n+")"))})})}),n._loadingTimeout=setTimeout(function(){r._showLoading()},n._loadingDelay)})}},{key:"_loadView",value:function(e,t){var n=this,r=this;e.data&&(e=e.data);var o=void 0;return o=e.params?$.extend({},e.params,t):$.extend({},t),e.user&&r.userVersion!=e.user.version&&(r.clearViewCache(),r.setUserConfig(e.user)),this.getApplicationVersion()!=e.version&&location.reload(),this._getViewObject(this.currentView).then(function(t){return r._initViewObject(t,e).then(function(){return Promise.resolve(t.load(o))}).then(function(){return Promise.resolve(r._loadContentData(t,e))}).then(function(){return Promise.resolve(r._hookView(t))}).then(function(){return Promise.resolve(r._loadModel(t,e.model))}).then(function(){return Promise.resolve(r._checkAnchor(t))}).then(function(){return Promise.resolve(r._checkOnLoadScroll())})}).catch(function(e){return n._stopObservation(),n._showFatalError(e),Promise.reject(e)})}},{key:"_initViewObject",value:function(e,t){return window.view=e,e._validateable=t.validateable||!1,Promise.resolve(e.init(location.hash))}},{key:"_loadContentData",value:function(e,t){var n=this;return t.html?Promise.resolve(this._loadContent(e,t.html)).then(function(){n._setViewCache(n.currentView,t.html,!1)}):this._isViewCached(this.currentView)?Promise.resolve(this._loadContent(e,this._getViewCachedHTML(this.currentView))):Promise.reject(new Error("View not cached and not recieved from html..."))}},{key:"_loadContent",value:function(e,t){"undefined"!=typeof e&&"function"==typeof e.draw?e.draw(t):$("#content").html(t),scrollTo(0,0)}},{key:"_hookView",value:function(e){var t=this;return"function"==typeof e._preHook&&e._preHook(),Promise.resolve(e.hook()).then(function(){return t._onViewHook(e)})}},{key:"_onViewHook",value:function(e){}},{key:"_loadModel",value:function(e,t){t=this.recursiveCleanFloats(t),this.debug&&console.debug(t),this.emit("preInject"),e.inject(t),this.emit("postInject"),"function"==typeof e._postInject&&e._postInject(),this._onViewInject(e,t),$(".page-title").length&&(window.document.title=$(".page-title").text())}},{key:"_onViewInject",value:function(e,t){}},{key:"_checkAnchor",value:function(e){var t=e.parseHash(this.hash);if(t.params.anchor){var n=t.params.anchor,r=$("[anchor="+n+"]");if(0===r.length)return this.debug&&console.warn('GET parameter "anchor" found but there is no element associated with it!'),!1;"function"==typeof e.onScrollToAnchor?e.onScrollToAnchor(r,n):this.debug&&console.warn('GET parameter "anchor" found but there is no `onScrollToAnchor` function on your view!')}}},{key:"_checkOnLoadScroll",value:function(){var e=this.getOnLoadScroll();e&&this.isNumber(e.X)&&this.isNumber(e.Y)&&(window.scrollTo(e.X,e.Y),this.clearOnLoadScroll())}},{key:"setOnLoadScroll",value:function(e,t){this._onLoadScroll={X:this.parseInt(e),Y:this.parseInt(t)}}},{key:"getOnLoadScroll",value:function(){return this._onLoadScroll}},{key:"clearOnLoadScroll",value:function(){delete this._onLoadScroll}},{key:"recursiveCleanFloats",value:function(e){var t=this;if($.isArray(e))for(var n=0;n<e.length;n++)e[n]=t.recursiveCleanFloats(e[n]);else if("object"==("undefined"==typeof e?"undefined":s(e)))for(var r in e)e[r]=t.recursiveCleanFloats(e[r]);else if("string"==typeof e&&e.match(/^\d+\.\d+$/i)){var o=parseFloat(e);isNaN(o)||(e=o)}return e}},{key:"clearViewCache",value:function(){this.debug&&console.log("Clearing view cache"),delete this._view_cache,this._view_cache=[]}},{key:"_isViewCached",value:function(e){return!(!this._view_cache[e]||!this._view_cache[e].html)}},{key:"_getViewCachedHTML",value:function(e){if(this._view_cache[e]&&this._view_cache[e].html)return this._view_cache[e].html;throw this._throw("View was supposed to be cached...",!0)}},{key:"_getViewCachedParams",value:function(e){return this._view_cache[e].params}},{key:"_setViewCache",value:function(e,t,n){delete this._view_cache[e],this._view_cache[e]={html:t,params:n?n:null},this.debug&&console.debug('Cached version of view "'+e+'"')}},{key:"_showLoading",value:function(){if(this._loadingTimeout){if(clearTimeout(this._loadingTimeout),this._loadingTimeout=0,this.debug&&console.debug("Show loading overlay"),$("#loading-overlay").length>0)return;this.showOverlay(),$("body").append('<img id="loading-overlay-image" src="'+this.IMG_PATH+'ajax-loader-big.gif" /><div id="loading-overlay"></div>');var e=$("#main").height()+parseInt($("#main").css("padding-top"),10)+parseInt($("#main").css("padding-bottom"),10);$("#loading-overlay-image").css({top:$("#main").offset().top,paddingTop:parseInt(e/2,10)+"px",position:"absolute",left:Math.floor($("#main").width()/2),zIndex:89}),$("#loading-overlay").css({height:e,left:0,position:"absolute",top:$("#main").offset().top,width:"100%",zIndex:90,backgroundColor:"#000",opacity:.4}).fadeIn()}}},{key:"beforeHideLoading",value:function(){}},{key:"_hideLoading",value:function(){this.beforeHideLoading(),clearTimeout(this._loadingTimeout),this._loadingTimeout=0,this.debug&&console.debug("Hide loading overlay"),$("#loading-overlay").remove(),$("#loading-overlay-image").remove(),this.hideOverlay(),this.afterHideLoading()}},{key:"afterHideLoading",value:function(){}},{key:"showOverlay",value:function(e,t,n,r){r||(r=500),n||(n="overlay"),this.debug&&console.debug("Show overlay"),$("#"+n).length>0||($("body").append('<div id="'+n+'"></div>'),e||(e="transparent"),t||(t="0"),$("#"+n).css({height:$(document).height(),left:0,position:"absolute",top:0,width:this._iPad?$("body").width():"100%",zIndex:r,backgroundColor:e,opacity:t}).fadeIn())}},{key:"hideOverlay",value:function(e){this.debug&&console.debug("Hide overlay"),e||(e="overlay"),$("#"+e).remove()}},{key:"addHistory",value:function(e){this._history[this._history.length-1]&&this._history[this._history.length-1].hash==e||this._history.push({hash:e,context:{}})}},{key:"_detectStepBack",value:function(e){return!(!this._history[this._history.length-2]||this._history[this._history.length-2].hash!=e)&&(this._history.pop(),!0)}},{key:"stepBack",value:function(e){var t;do{if(0===this._history.length){t="";break}if(t=this._history.pop().hash,"undefined"==typeof t){t="";break}}while(t==location.hash);return this.debug&&console.debug("Step back to : "+t),(e||"undefined"==typeof e)&&(location.hash=t),t}},{key:"forceReload",value:function(){location.reload()}},{key:"forceStepBack",value:function(){this._stopObservation(),this.debug&&this._debugHistory();var e=this.stepBack(!1);""!==e?(location.hash=e,location.reload()):(history.back(),location.reload())}},{key:"goBack",value:function(e){"undefined"==typeof e&&(e=""),this._history.length>=2&&(this._history.pop(),e=this._history.pop().hash),this.debug&&console.debug('Go back to "'+e+'"'),location.hash=e}},{key:"forceGoBack",value:function(){var e;this._stopObservation(),this._history.length<2?e="":(this._history.pop(),e=this._history.pop().hash),this.debug&&console.debug('Force go back to "'+e+'"'),location.hash=e,location.reload()}},{key:"setContextValue",value:function(e,t){this._history.length>0&&($.isPlainObject(this._history[this._history.length-1].context)||(this._history[this._history.length-1].context={}),this._history[this._history.length-1].context[e]=t)}},{key:"getContextValue",value:function(e){return!!(this._history.length>0&&$.isPlainObject(this._history[this._history.length-1].context))&&this._history[this._history.length-1].context[e]}},{key:"getContext",value:function(){if(!this._history.length)return{};var e=this._history[this._history.length-1],t=e.context||{};return t}},{key:"_debugHistory",value:function(){for(var e=0;e<this._history.length;e++)console.debug(e+" : "+this._history[e].hash),console.debug(this._history[e].state)}},{key:"_arrayPop",value:function(e,t){if(e.length&&t>0&&t<e.length){for(var n=t;n<e.length-1;n++)e[n]=e[n+1];e.pop()}return e}},{key:"_getViewObject",value:function(e){var t=this;return this._view_objects[e]?Promise.resolve(this._view_objects[e]):this.router.getClass(e).then(function(n){var r=new n(t);return t._view_objects[e]=r,r}).catch(function(e){return console.log(e),Promise.reject(e)})}},{key:"_scrollTop",value:function(){var e=window.pageYOffset?window.pageYOffset:0,t=document.documentElement?document.documentElement.scrollTop:0,n=document.body?document.body.scrollTop:0,r=e?e:0;return r=t&&(!r||r>t)?t:r,r=n&&(!r||r>n)?n:r}},{key:"showModalDialog",value:function(e,t,n,r){var o=this;this.showOverlay("#000",.4);var i=$("<div></div>").addClass("modal-2").append($("<div></div>").addClass("sprite modal-3").append(e));
r&&i.css("width",r);var a=$("<div></div>").addClass("modal").attr("id","modal_dialog").css({display:"none",top:o._scrollTop()+"px"}).append(i);return $("body").append(a),new Promise(function(e){a.slideDown(t,e)}).then(function(){return"function"==typeof n&&n(a),a})}},{key:"hideModalDialog",value:function(e,t,n){var r=this,o=$("#modal_dialog");return new Promise(function(t){o.fadeOut(e,t)}).then(function(){r.hideOverlay(),n?o.detach():o.remove(),"function"==typeof t&&t()})}},{key:"hideModalDialogNow",value:function(){this.debug&&console.debug("Hide modal dialog now!"),$("#modal_dialog").remove()}},{key:"getShowErrorHTML",value:function(e){var t=this;return'<div class="modal-dialog"><h2>'+t._("ERROR")+"</h2>\t\t\t\t\t\t\t<p>\t\t\t\t\t\t\t\t<strong>"+(e?t._(e):t._("FATAL_ERROR_OCCURED"))+"</strong>\t\t\t\t\t\t\t\t<br />\t\t\t\t\t\t\t\t"+t._("ERROR_TRY_AGAIN")+"\t\t\t\t\t\t\t\t<br />\t\t\t\t\t\t\t\t"+t._("CONTACT_SUPPORT_PERSIST")+'\t\t\t\t\t\t\t</p>\t\t\t\t\t\t\t<p class="submit">\t\t\t\t\t\t\t\t<input type="submit" id="hook_create_error_close" value="'+t._("OK")+'" />\t\t\t\t\t\t\t</p></div>'}},{key:"showError",value:function(e,t){var n=this;n.showModalDialog(n.getShowErrorHTML(e),"fast",function(){$("#hook_create_error_close").safeClick(function(){n.hideModalDialog("fast"),t&&t()})})}},{key:"detectedExpiredSession",value:function(e){var t=this;this.detectedExpiredSessionTimeout||(this.detectedExpiredSessionGoTo=e,this.detectedExpiredSessionTimeout=setTimeout(function(){t.showSessionExpiredError(t.detectedExpiredSessionGoTo)},100))}},{key:"clearDetectedExpiredSession",value:function(){this.detectedExpiredSessionGoTo=!1,this.detectedExpiredSessionTimeout&&(clearTimeout(this.detectedExpiredSessionTimeout),this.detectedExpiredSessionTimeout=!1)}},{key:"detectedNetworkError",value:function(e){var t=this;this.detectedNetworkErrorTimeout||(this.detectedNetworkErrorGoTo=e,this.detectedNetworkErrorTimeout=setTimeout(function(){t.showXHRNetworkErrorError(t.detectedNetworkErrorGoTo)},100))}},{key:"clearDetectedNetworkError",value:function(){this.detectedNetworkErrorGoTo=!1,this.detectedNetworkErrorTimeout&&(clearTimeout(this.detectedNetworkErrorTimeout),this.detectedNetworkErrorTimeout=!1)}},{key:"getShowSessionExpiredError",value:function(){var e=this;return'<div class="modal-dialog"><h2>'+e._("INVALID_CREDENTIAL_ERROR_TITLE")+"</h2>\t\t\t\t\t<p>\t\t\t\t\t\t<strong>"+e._("INVALID_CREDENTIAL_ERROR_BODY")+'</strong>\t\t\t\t\t\t<br />\t\t\t\t\t</p>\t\t\t\t\t<p class="submit">\t\t\t\t\t\t<input type="submit" id="hook_session_expired_error_close" value="'+e._("OK")+'" />\t\t\t\t\t</p>\t\t\t\t</div>'}},{key:"showSessionExpiredError",value:function(e){var t=this;e=e||t.VIRTUALPATH||"/?logout",t.showModalDialog(t.getShowSessionExpiredError(),"fast",function(){$("#hook_session_expired_error_close").safeClick(function(){document.location=e,t.clearDetectedExpiredSession()})})}},{key:"getShowXHRNetworkError",value:function(){var e=this;return'<div class="modal-dialog"><h2>'+e._("XHR_NETWORK_ERROR_TITLE")+"</h2>\t\t\t\t\t<p>\t\t\t\t\t\t<strong>"+e._("XHR_NETWORK_ERROR_BODY")+'</strong>\t\t\t\t\t\t<br />\t\t\t\t\t</p>\t\t\t\t\t<p class="submit">\t\t\t\t\t\t<input type="submit" id="hook_xhr_network_error_close" value="'+e._("OK")+'" />\t\t\t\t\t</p>\t\t\t\t</div>'}},{key:"showXHRNetworkErrorError",value:function(e){var t=this;e=e||t.VIRTUALPATH||"/?logout",t.showModalDialog(t.getShowXHRNetworkError(),"fast",function(){$("#hook_xhr_network_error_close").safeClick(function(){document.location=e,t.clearDetectedNetworkError()})})}},{key:"getShowConfirmationHTML",value:function(e,t){var n=this;return'<div class="modal-dialog"><h2>'+e+"</h2>\t\t\t\t\t\t\t\t<p>"+t+'</p>\t\t\t\t\t\t\t<p class="submit">\t\t\t\t\t\t\t\t<input type="button" id="hook_confirmation_yes" value="'+n._("YES")+'" />\t\t\t\t\t\t\t\t<input type="button" id="hook_confirmation_no" value="'+n._("NO")+'" />\t\t\t\t\t\t\t</p></div>'}},{key:"showConfirmation",value:function(e,t,n,r){var o=this;o.showModalDialog(o.getShowConfirmationHTML(e,t),"fast",function(){$("#hook_confirmation_yes").safeClick(function(){n&&n(),o.hideModalDialog("fast")}),$("#hook_confirmation_no").safeClick(function(){r&&r(),o.hideModalDialog("fast")})})}},{key:"showMessage",value:function(e,t,n){var r=this;""===e&&this._throw("Missing title",!0),""===t&&this._throw("Missing message",!0),r.showModalDialog("<h2>"+e+"</h2>\t\t\t\t\t\t\t<p>\t\t\t\t\t\t\t\t<strong>"+t+"</strong>\t\t\t\t\t\t\t</p>\t\t\t\t\t\t\t"+(n?"<p>"+n+"</p>":"")+'\t\t\t\t\t\t\t<p class="submit">\t\t\t\t\t\t\t\t<input type="submit" id="hook_show_message_close" value="'+r._("OK")+'" />\t\t\t\t\t\t\t</p>',"fast",function(){$("#hook_show_message_close").safeClick(function(){r.hideModalDialog("fast")})})}},{key:"showQuestionCommentDialog",value:function(e){function t(){return $("#file_upload").ajaxUploader({url:"index.php?k="+o.SESSION_KEY+"&uploadFile&tmp_dir="+o.tmp_dir,autoUpload:!0,progressBarConfig:{barImage:"img/progressbg_orange.gif"},success:function(e,r){if(e.ajax_filename){var i=a++,s=e.ajax_filename;o.tmp_dir=e.tmp_dir,$("#uploaded_files_names").append('<li id="ajax_file_'+i+'" style="list-style:none;">'+s+'&nbsp&nbsp<span class="ico icon-cross" id="ajax_file_remove_'+i+'" style="position: absolute; margin-bottom:10px;"></span></li>'),$("#ajax_file_remove_"+i).on("click",function(){n(o.tmp_dir,s,i)}),o.QCS_uploader.push(t())}else e.error&&(console.debug(e.error),o.showMessage(o._("ERROR"),o._("UPLOAD_FILE_ERROR_OCCURED")))},error:function(e){function t(t,n,r){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e,t,n){console.debug("Error uploading attachment."),o.showMessage(o._("ERROR"),o._("UPLOAD_FILE_ERROR_OCCURED"))})})}function n(e,t,n){var r="&file="+encodeURIComponent(t)+"&fld="+encodeURIComponent(e);$.ajax({url:"index.php?k="+o.SESSION_KEY+"&removeQCSAjaxFile",type:"POST",data:r,dataType:"json",headers:o.getXSRFHeaders(),success:function(e){return $("#ajax_file_"+n).remove(),$("#ajax_file_remove_"+n).remove(),!0},error:function(e){function t(t,n,r){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e,t,n){o.validateXHR(e).then(function(e){e&&console.log(n)})})})}function r(e){o.tmp_dir="",$.ajax({url:"index.php?k="+o.SESSION_KEY+"&removeQCSAjaxFolder",type:"POST",data:"&fld="+encodeURIComponent(e),dataType:"json",headers:o.getXSRFHeaders(),success:function(e){return!0},error:function(e){function t(t,n,r){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e,t,n){o.validateXHR(e).then(function(e){e&&console.log(n)})})})}var o=this,i="<h2>"+o._("QUESTION_COMMENT_SUGGESTION")+'</h2>\t\t\t<div class="header_line"></div>\t\t\t<div id="hook_question_comment_form">\t\t\t<dl class="form left_form">\t\t\t<dt><label style="width:100px">'+o._("COMMENT_TYPE")+'</label></dt>\t\t\t<dd><select id="hook_question_comment_type">\t\t\t<option value="QUESTION">'+o._("QUESTION")+'</option>\t\t\t<option value="COMMENT">'+o._("COMMENT")+'</option>\t\t\t<option value="SUGGESTION">'+o._("SUGGESTION")+'</option>\t\t\t</select></dd>\t\t\t<dt><label style="width:100px">'+o._("COMMENT_FROM")+'</label></dt>\t\t\t<dd><input type="text" id="hook_question_comment_from" style="width:350px" disabled="disabled" /></dd>\t\t\t<dt><label style="width:100px">'+o._("COMMENT_SUBJECT")+'</label></dt>\t\t\t<dd><input type="text" id="hook_question_comment_subject" style="width:350px" /></dd>\t\t\t<div id="hook_question_comment_attachement_div">\t\t\t<dt><label style="width:100px">'+o._("ATTACHMENT")+'</label></dt>\t\t\t<dd><div id="file_upload"></div></dd>\t\t\t<dd><ul style="margin-left:115px;" id="uploaded_files_names"></ul><dd>\t\t\t<br />\t\t\t</div>\t\t\t<dd><textarea id="hook_question_comment_textarea" style="width:500px;height:150px"></textarea></dd>\t\t\t</dl>\t\t\t<p class="submit">\t\t\t<input type="submit" id="hook_send_question_comment" value="'+o._("OK")+'" /> <a href="javascript:void(0);" id="hook_cancel_question_comment">'+o._("CANCEL")+'</a>\t\t\t</p>\t\t\t</div>\t\t\t<div id="hook_question_comment_sent" style="display:none"><p>'+o._("THANK_YOU_FOR_YOUR_COMMENTS")+"</p></div>",a=0;o.showModalDialog(i,"normal",function(){e&&$("#hook_question_comment_type").val(e),$("#hook_question_comment_from").val(o.userEmail),$("#hook_send_question_comment").safeClick(function(){var e=$("#hook_question_comment_type").val(),t=$("#hook_question_comment_subject").val(),n=$("#hook_question_comment_from").val(),i=$("#hook_question_comment_textarea").val();if(!t)return $("#hook_question_comment_subject").hintError(o._("FIELD_REQUIRED")).focus(),!1;if(!i)return $("#hook_question_comment_textarea").hintError(o._("FIELD_REQUIRED")).focus(),!1;var a="&type="+encodeURIComponent(e)+"&subject="+encodeURIComponent(t)+"&from="+encodeURIComponent(n)+"&message="+encodeURIComponent(i)+"&tmp_dir="+encodeURIComponent(o.tmp_dir);$.ajax({url:"index.php?k="+o.SESSION_KEY+"&sendComment",type:"POST",data:a,dataType:"json",headers:o.getXSRFHeaders(),success:function(e){return e.status&&"error"==e.status?(o.showError(),o.hideModalDialog("fast"),!1):(setTimeout(function(){o.hideModalDialog("fast")},2e3),r(o.tmp_dir),!0)},error:function(e){function t(t,n,r){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e,t,n){o.hideModalDialog("fast"),o.validateXHR(e).then(function(e){e&&o.showError()})})}),$("#hook_question_comment_form").fadeOut(function(){$("#hook_question_comment_sent").show()})}),$("#hook_cancel_question_comment").safeClick(function(){o.tmp_dir="",o.hideModalDialog("fast")}),$("#hook_question_comment_subject").focus()},550),this.QCS_uploader=[],this.QCS_uploader.push(t())}},{key:"requestUnmount",value:function(e){this.unmounts.push(e)}},{key:"performUnmounts",value:function(){this.unmounts.forEach(function(e){e()}),this.unmounts=[]}},{key:"htmlEntity",value:function(e){return e||this.isNumber(e)?$("<div></div>").text(e).html():""}},{key:"sleep",value:function(e){var t,n=new Date;do t=new Date;while(t-n<e)}},{key:"generateGUID",value:function(){var e=function(){return Math.floor(65536*Math.random()).toString(16)};return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}},{key:"isNumber",value:function(e){return"number"==typeof e&&isFinite(e)}},{key:"parseFloat",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){if("number"==typeof e)return e;e+=";",e=e.replace(/[^\d\-.,]/g,""),"fr"==this.lang&&e.indexOf(",")!=-1&&(e=e.replace(/\./g,""),e=e.replace(/\,/g,".")),e=e.replace(/\,/g,"");var t=parseFloat(e);return isNaN(t)&&(t=0),t})},{key:"parseInt",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){return e=parseInt(e,10),isNaN(e)&&(e=0),e})},{key:"formatMoney",value:function(e,t){if(t&&t.canBeNull&&(""===e||null===e))return"";var n;n="fr"==this.lang?"right":"left";var r=this.formatNumber(e,t);return r||(r="0"),"left"==n?t&&t.nbsp?"$"+r:"$"+r:t&&t.nbsp?r+"&nbsp;$":r+" $"}},{key:"formatMoneyForInput",value:function(e,t){var n={precision:t?t:2,facultative_decimals:!1,decimal_separator:".",thousand_separator:""};return this.formatNumber(e,n)}},{key:"formatPercent",value:function(e,t){var n;if(t&&t.canBeNull&&!e)return"";n="fr"==this.lang?t&&t.nbsp?"&nbsp":" ":"";var r=this.formatNumber(e,t);return r||(r="0"),r+n+"%"}},{key:"formatNumber",value:function(e,t){if(0===arguments.length)return"";if(!e&&0!==e)return"";var n={precision:2,facultative_decimals:!0,positive:!1,nbsp:!1,rounded:!0};n="fr"==this.lang?$.extend({decimal_separator:",",thousand_separator:" "},n):$.extend({decimal_separator:".",thousand_separator:","},n);var r=$.extend(n,t);e+="";var o=!1;"-"==e.charAt(0)&&(r.positive?e="0":(o=!0,e=e.substr(1))),e=e.replace(/[^\d\-.,]/g,""),","==r.decimal_separator&&e.indexOf(r.decimal_separator)!=-1&&(e=e.replace(/\./g,""),e=e.replace(/,/g,".")),""===e&&(e="0"),e=e.replace(/,/g,""),e=parseFloat(e)+"",e==Number.NaN&&(e="");var i,a;0===r.precision?(i=this.parseFloat(e).toFixed(0),a=i):(i=r.rounded?(Math.round(e*Math.pow(10,r.precision))/Math.pow(10,r.precision)).toFixed(r.precision):(Math.floor(e*Math.pow(10,r.precision))/Math.pow(10,r.precision)).toFixed(r.precision),a=i.substr(0,i.indexOf(".")));var s="",u=a.length;if(u>3){do{u-=3;var c=3;u<0&&(c=3+u,u=0),s=""!==s?a.substr(u,c)+r.thousand_separator+s:a.substr(u,c)}while(u>0)}else s=a;var l;return 0===r.precision||r.facultative_decimals&&0===parseInt(i.substr(i.indexOf(".")+1))?l=s:(s+=r.decimal_separator,l=s+i.substr(i.indexOf(".")+1)),r.end_space&&(l+=" "),r.nbsp&&(l=l.replace(/ /g,"&nbsp;")),o?"-"+l:l}},{key:"formatSIN",value:function(e){var t=e;t=t.replace(new RegExp("[^\\d]","g"),"");var n=t.substr(0,3)+" "+t.substr(3,3)+" "+t.substr(6,3);return $.trim(n)}},{key:"isSINValid",value:function(e){if(""===e)return!0;if("*** *** ***"==e)return!0;if(e=e.replace(new RegExp("[^\\d]","g"),""),9!=e.length)return!1;for(var t=parseInt(e.charAt(0))+parseInt(e.charAt(2))+parseInt(e.charAt(4))+parseInt(e.charAt(6)),n=1;n<=7;n+=2){var r=2*parseInt(e.charAt(n));r>=10&&(r-=9),t+=r}return t+=parseInt(e.charAt(8)),t%10===0}},{key:"formatFieldValue",value:function(e){var t=this;if(!e)return"";if("object"==("undefined"==typeof e?"undefined":s(e))){var n=e["value_"+t.lang];return"undefined"==typeof n?"":n}return e}},{key:"parsePhone",value:function(e){var t;if(/(,|ext|poste|#)/.test(e)){var n=e.indexOf(","),r=e.indexOf("ext"),o=e.indexOf("poste"),i=e.indexOf("#"),a=Math.max(n,r,o,i);a!=-1&&(t=e.substr(a).replace(/[^\d]/g,""),e=e.substr(0,a))}else t="";e=e.replace(/[^\d]/g,"");var s;return"1"==e[0]&&e.length>=11?(s="1 "+e.substr(1,3)+" "+e.substr(4,3)+"-"+e.substr(7,4),e.length>11&&(t=e.substr(11))):e.length>=10?(s=e.substr(0,3)+" "+e.substr(3,3)+"-"+e.substr(6,4),e.length>10&&(t=e.substr(10))):s=7==e.length?e.substr(0,3)+"-"+e.substr(3):e,t&&(s+=this._("PHONE_EXTENSION")+t),s}},{key:"formatPostalCode",value:function(e){return/^[a-zA-Z]\d[a-zA-Z]\d[a-zA-Z]\d$/.test(e)?(e.substr(0,3)+" "+e.substr(3)).toUpperCase():e}},{key:"pad",value:function(e,t){for(var n=""+e;n.length<t;)n="0"+n;return n}},{key:"interpolate",value:function(e,t){var n;if(null!==t&&"object"===("undefined"==typeof t?"undefined":s(t)))for(;n=/{([a-z0-9._]+)}/gi.exec(e);)e=e.replace(n[0],t[n[1]]||"");return e}},{key:"validateXHR",value:function(e){var t=this;return new Promise(function(n){return e&&"undefined"!=typeof e?"abort"===e.statusText?void n(!1):0===e.status?void setTimeout(function(){t.showXHRNetworkErrorError(!!e.responseJSON&&e.responseJSON.view),n(!1)}):401==e.status?(t.showSessionExpiredError(!!e.responseJSON&&e.responseJSON.view),void n(!1)):void n(!0):void n(!1)})}},{key:"getXHRRequest",value:function(e,t,n,r,o,i){var a=this,s=$.ajax({url:e,type:"GET",dataType:"json",success:function(e){i||(a.hideOverlay(),a._hideLoading()),o&&$(o).prop("disabled",!1);var n;n="undefined"!=typeof e.data?e.data:e,e.status&&"error"==e.status?"function"==typeof r?r(n):"undefined"!=typeof n.message?a.showError(n.message):a.showError():"function"==typeof t&&t(n)},error:function(e){function t(t,n,r){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e,t,n){var s=this;i||(a.hideOverlay(),a._hideLoading()),o&&$(o).prop("disabled",!1),a.validateXHR(e).then(function(e){e&&(s.debug&&(console.debug("AJAX query error"),console.debug(t),console.debug(n)),"function"==typeof r?r():a.showError())})})});return s}},{key:"registerXHR",value:function(e){this._ongoing_xhrs.push(e)}},{key:"unregisterXHR",value:function(e){var t=this._ongoing_xhrs.indexOf(e);t>=0&&this._ongoing_xhrs.splice(t,1)}},{key:"abortOngoingXHR",value:function(){this.fetchService.abortOngoingFetchPromises(),$.each(this._ongoing_xhrs,function(e,t){"undefined"!=typeof t&&t.abort()}),this._ongoing_xhrs=[]}},{key:"getViewUrl",value:function(e,t,n){return n.length>0&&"&"!==n[0]&&(n="&"+n),"index.php?k="+encodeURIComponent(this.SESSION_KEY)+"&view="+encodeURIComponent(e)+"&cmd="+encodeURIComponent(t)+n}},{key:"fetch",value:function(e,t){var n=this;t||(t={});var r=t.showLoading===!0,o=t.showOverlay===!0&&!r;o&&this.showOverlay();var i=!!t.button&&$(button);return i&&i.prop("disabled",!0),r&&(this._loadingTimeout=setTimeout(function(){n._showLoading()},this._loadingDelay)),this.fetchService.fetch(e,t).finally(function(){r&&n._hideLoading(),o&&n.hideOverlay(),i&&i.prop("disabled",!1)})}},{key:"fetchJson",value:function(e,t){return this.fetch(e,t).then(v.default.parseJSON).then(v.default.handleApplicationResponseData)}},{key:"get",value:function(e,t,n,r,o,i,a,s){var u=this,c={buttonSelector:a,showLoading:o,showOverlay:!o&&!s};return this.fetch(this.getViewUrl(e,t,n),c).then(v.default.parseJSON).then(v.default.handleApplicationResponseData).then(function(e){return"function"==typeof r&&r(e),e}).catch(function(e){throw u.handleFetchError(e,i),e})}},{key:"post",value:function(e,t,n,r,o,i,a,s,u){var c=this,l={buttonSelector:s,showLoading:i,showOverlay:!i&&!u};return l=v.default.addPostOptions(r,l),this.fetch(this.getViewUrl(e,t,n),l).then(v.default.parseJSON).then(v.default.handleApplicationResponseData).then(function(e){return"function"==typeof o&&o(e),e}).catch(function(e){throw c.handleFetchError(e,a),e})}},{key:"handleFetchError",value:function(e,t){var n=void 0,r=void 0;if("object"===("undefined"==typeof e?"undefined":s(e))){if(e instanceof _.FetchAbortError)return;e instanceof _.FetchResponseDataError&&(console.log(e),e.data&&(r=e.data,n=r.message))}"function"==typeof t?t(r):this.showError(n)}},{key:"datepicker",value:function(e,t){var n=this;return $(e).bind("change",function(){this.value=n.date.format(this.value,"input")}).datepicker(t)}},{key:"_formatAddress",value:function(e,t,n,r,o,i){var a="",s=!0;return""!==e&&e!==!1&&(s=!1,a+=this.htmlEntity(e)),""!==t&&t!==!1&&(s||(a+=", "),s=!1,a+=this.htmlEntity(t)),""!==n&&n!==!1&&(s||(a+=", "),s=!1,a+=this.htmlEntity(n)),""!==r&&"QC"!=r&&(s||(a+=", "),s=!1,a+=this.htmlEntity(r)),""!==i&&i!==!1&&(s||(a+=", "),s=!1,a+=this.htmlEntity(i)),""!==o&&o!==!1&&"Canada"!=o&&(s||(a+=", "),s=!1,a+=this.htmlEntity(o)),a}},{key:"formatAddress",value:function(e,t,n,r,o,i){return this._formatAddress(e,t,n,r,o,i)}},{key:"formatGMapAddress",value:function(e,t,n,r,o,i){return e=$.trim(e),t=$.trim(t),n=$.trim(n),o=$.trim(o),i=$.trim(i),e=e.replace(/\bboul\./i,"Boulevard"),e=e.replace(/,\s?\b(bur|bureau|app|appartement|appartment|local|office|porte|door)\b\.?\s*\d*/i,""),(e?e+", ":"")+(t?t+", ":"")+(n?n+", ":"")+(r?r+", ":"")+(i?i+", ":"")+o}},{key:"isMobile",value:function(){return null!==navigator.userAgent.match(/iPhone/i)||null!==navigator.userAgent.match(/iPod/i)||null!==navigator.userAgent.match(/Pre/i)||null!==navigator.userAgent.match(/Android/i)}},{key:"downloadFile",value:function(e){var t=this;if(t._iPad){var n="<h2>"+t._("DOWNLOAD_FILE_DIALOG_TITLE")+'</h2>\t\t\t\t<div class="header_line"></div>\t\t\t\t<a id="hook_download_file" href="javascript:void(0);">'+t._("DOWNLOAD_FILE")+"</a>\t\t\t\t<br /><br />";t.showModalDialog(n,"normal",function(){$("#hook_download_file").click(function(){window.open(e,"_blank"),t.hideModalDialog("fast")})})}else{var r="download_iframe",o=document.getElementById(r);o||(o=document.createElement("iframe"),o.id=r,o.name=r,o.style.position="absolute",o.style.top="-1000px",o.style.left="-1000px",document.body.appendChild(o)),o.src=e}}},{key:"getIEVersion",value:function(){var e=null;if("Microsoft Internet Explorer"==navigator.appName){var t=navigator.userAgent,n=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");null!=n.exec(t)&&(e=parseFloat(RegExp.$1))}return e}},{key:"isIE7",value:function(){var e=this.getIEVersion();return e=null!==e?e:999,e<8}},{key:"isIE9",value:function(){var e=this.getIEVersion();return e>=9&&e<10}},{key:"isOpera",value:function(){return"Opera"==navigator.appName}},{key:"checkStoredSession",value:function(){var e=this;if(this.canUseSessionStorage()){var t=e.getXSRFToken();if(!t||!e._xsrf_cookie_name)throw this._throw("Cannot check stored session without XSRF Token");window.opener&&sessionStorage.getItem("window-name")!=window.name&&(this.debug&&console.debug("Opened from another tab, clearing cloned stored session"),sessionStorage.clear(),sessionStorage.setItem(e._xsrf_cookie_name,t));var n=sessionStorage.getItem(e._xsrf_cookie_name);n&&n==t||(this.debug&&console.log("Session cookie changed, clearing stored session"),sessionStorage.clear(),sessionStorage.setItem(e._xsrf_cookie_name,t)),sessionStorage.getItem("window-name")||sessionStorage.setItem("window-name",window.name);var r=sessionStorage.getItem("SESSION_KEY");r?(this.replaced_session_key=this.SESSION_KEY,this.SESSION_KEY=r,this.debug&&console.log('Replaced given session key "'+this.replaced_session_key+'" for stored session key "'+this.SESSION_KEY+'"')):sessionStorage.setItem("SESSION_KEY",this.SESSION_KEY)}}},{key:"canUseSessionStorage",value:function(){try{return!!sessionStorage.getItem&&!!$.cookie}catch(e){return!1}}},{key:"forceElementRedraw",value:function(e){e.hide().show()}},{key:"getByKey",value:function(e,t){for(var n=e,r=t.split("."),o=0;o<r.length;o++){if("object"!=("undefined"==typeof n?"undefined":s(n)))return;n=n[r[o]]}return n}}]),t}(l.default);t.default=m},function(e,t){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function r(e){return"function"==typeof e}function o(e){return"number"==typeof e}function i(e){return"object"==typeof e&&null!==e}function a(e){return void 0===e}e.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(e){if(!o(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},n.prototype.emit=function(e){var t,n,o,s,u,c;if(this._events||(this._events={}),"error"===e&&(!this._events.error||i(this._events.error)&&!this._events.error.length)){if(t=arguments[1],t instanceof Error)throw t;var l=new Error('Uncaught, unspecified "error" event. ('+t+")");throw l.context=t,l}if(n=this._events[e],a(n))return!1;if(r(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:s=Array.prototype.slice.call(arguments,1),n.apply(this,s)}else if(i(n))for(s=Array.prototype.slice.call(arguments,1),c=n.slice(),o=c.length,u=0;u<o;u++)c[u].apply(this,s);return!0},n.prototype.addListener=function(e,t){var o;if(!r(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,r(t.listener)?t.listener:t),this._events[e]?i(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,i(this._events[e])&&!this._events[e].warned&&(o=a(this._maxListeners)?n.defaultMaxListeners:this._maxListeners,o&&o>0&&this._events[e].length>o&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace())),this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(e,t){function n(){this.removeListener(e,n),o||(o=!0,t.apply(this,arguments))}if(!r(t))throw TypeError("listener must be a function");var o=!1;return n.listener=t,this.on(e,n),this},n.prototype.removeListener=function(e,t){var n,o,a,s;if(!r(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(n=this._events[e],a=n.length,o=-1,n===t||r(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(i(n)){for(s=a;s-- >0;)if(n[s]===t||n[s].listener&&n[s].listener===t){o=s;break}if(o<0)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(o,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},n.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[e],r(n))this.removeListener(e,n);else if(n)for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},n.prototype.listeners=function(e){var t;return t=this._events&&this._events[e]?r(this._events[e])?[this._events[e]]:this._events[e].slice():[]},n.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(r(t))return 1;if(t)return t.length}return 0},n.listenerCount=function(e,t){return e.listenerCount(t)}},function(e,t,n){(function(t){"use strict";var r=n(6),o="undefined"!=typeof window?window:"undefined"!=typeof t?t:"undefined"!=typeof self?self:{},i=o.Raven,a=new r;a.noConflict=function(){return o.Raven=i,a},a.afterLoad(),e.exports=a}).call(t,function(){return this}())},function(e,t,n){(function(t){"use strict";function r(){return+new Date}function o(){this._hasJSON=!("object"!=typeof JSON||!JSON.stringify),this._hasDocument=!i(A),this._hasNavigator=!i(D),this._lastCapturedException=null,this._lastData=null,this._lastEventId=null,this._globalServer=null,this._globalKey=null,this._globalProject=null,this._globalContext={},this._globalOptions={logger:"javascript",ignoreErrors:[],ignoreUrls:[],whitelistUrls:[],includePaths:[],crossOrigin:"anonymous",collectWindowErrors:!0,maxMessageLength:0,maxUrlLength:250,stackTraceLimit:50,autoBreadcrumbs:!0,sampleRate:1},this._ignoreOnError=0,this._isRavenInstalled=!1,this._originalErrorStackTraceLimit=Error.stackTraceLimit,this._originalConsole=I.console||{},this._originalConsoleMethods={},this._plugins=[],this._startTime=r(),this._wrappedBuiltIns=[],this._breadcrumbs=[],this._lastCapturedEvent=null,this._keypressTimeout,this._location=I.location,this._lastHref=this._location&&this._location.href,this._resetBackoff();for(var e in this._originalConsole)this._originalConsoleMethods[e]=this._originalConsole[e]}function i(e){return void 0===e}function a(e){return"function"==typeof e}function s(e){return"[object String]"===M.toString.call(e)}function u(e){for(var t in e)return!1;return!0}function c(e,t){var n,r;if(i(e.length))for(n in e)f(e,n)&&t.call(null,n,e[n]);else if(r=e.length)for(n=0;n<r;n++)t.call(null,n,e[n])}function l(e,t){return t?(c(t,function(t,n){e[t]=n}),e):e}function h(e,t){return!t||e.length<=t?e:e.substr(0,t)+"…"}function f(e,t){return M.hasOwnProperty.call(e,t)}function d(e){for(var t,n=[],r=0,o=e.length;r<o;r++)t=e[r],s(t)?n.push(t.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")):t&&t.source&&n.push(t.source);return new RegExp(n.join("|"),"i")}function p(e){var t=[];return c(e,function(e,n){t.push(encodeURIComponent(e)+"="+encodeURIComponent(n))}),t.join("&")}function _(e){var t=e.match(/^(([^:\/?#]+):)?(\/\/([^\/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/);if(!t)return{};var n=t[6]||"",r=t[8]||"";return{protocol:t[2],host:t[4],path:t[5],relative:t[5]+n+r}}function v(){var e=I.crypto||I.msCrypto;if(!i(e)&&e.getRandomValues){var t=new Uint16Array(8);e.getRandomValues(t),t[3]=4095&t[3]|16384,t[4]=16383&t[4]|32768;var n=function(e){for(var t=e.toString(16);t.length<4;)t="0"+t;return t};return n(t[0])+n(t[1])+n(t[2])+n(t[3])+n(t[4])+n(t[5])+n(t[6])+n(t[7])}return"xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0,n="x"===e?t:3&t|8;return n.toString(16)})}function m(e){for(var t,n=5,r=80,o=[],i=0,a=0,s=" > ",u=s.length;e&&i++<n&&(t=g(e),!("html"===t||i>1&&a+o.length*u+t.length>=r));)o.push(t),a+=t.length,e=e.parentNode;return o.reverse().join(s)}function g(e){var t,n,r,o,i,a=[];if(!e||!e.tagName)return"";if(a.push(e.tagName.toLowerCase()),e.id&&a.push("#"+e.id),t=e.className,t&&s(t))for(n=t.split(/\s+/),i=0;i<n.length;i++)a.push("."+n[i]);var u=["type","name","title","alt"];for(i=0;i<u.length;i++)r=u[i],o=e.getAttribute(r),o&&a.push("["+r+'="'+o+'"]');return a.join("")}function y(e,t){return!!(!!e^!!t)}function b(e,t){return!y(e,t)&&(e=e.values[0],t=t.values[0],e.type===t.type&&e.value===t.value&&w(e.stacktrace,t.stacktrace))}function w(e,t){if(y(e,t))return!1;var n=e.frames,r=t.frames;if(n.length!==r.length)return!1;for(var o,i,a=0;a<n.length;a++)if(o=n[a],i=r[a],o.filename!==i.filename||o.lineno!==i.lineno||o.colno!==i.colno||o.function!==i.function)return!1;return!0}function k(e,t,n,r){var o=e[t];e[t]=n(o),r&&r.push([e,t,o])}var E=n(7),x=n(9),S=n(10),O=n(8),C=O.isError,T=O.isObject,R=n(11).wrapMethod,j="source protocol user pass host port path".split(" "),P=/^(?:(\w+):)?\/\/(?:(\w+)(:\w+)?@)?([\w\.-]+)(?::(\d+))?(\/.*)/,I="undefined"!=typeof window?window:"undefined"!=typeof t?t:"undefined"!=typeof self?self:{},A=I.document,D=I.navigator;o.prototype={VERSION:"3.14.0",debug:!1,TraceKit:E,config:function(e,t){var n=this;if(n._globalServer)return this._logDebug("error","Error: Raven has already been configured"),n;if(!e)return n;var r=n._globalOptions;t&&c(t,function(e,t){"tags"===e||"extra"===e||"user"===e?n._globalContext[e]=t:r[e]=t}),n.setDSN(e),r.ignoreErrors.push(/^Script error\.?$/),r.ignoreErrors.push(/^Javascript error: Script error\.? on line 0$/),r.ignoreErrors=d(r.ignoreErrors),r.ignoreUrls=!!r.ignoreUrls.length&&d(r.ignoreUrls),r.whitelistUrls=!!r.whitelistUrls.length&&d(r.whitelistUrls),r.includePaths=d(r.includePaths),r.maxBreadcrumbs=Math.max(0,Math.min(r.maxBreadcrumbs||100,100));var o={xhr:!0,console:!0,dom:!0,location:!0},i=r.autoBreadcrumbs;return"[object Object]"==={}.toString.call(i)?i=l(o,i):i!==!1&&(i=o),r.autoBreadcrumbs=i,E.collectWindowErrors=!!r.collectWindowErrors,n},install:function(){var e=this;return e.isSetup()&&!e._isRavenInstalled&&(E.report.subscribe(function(){e._handleOnErrorStackInfo.apply(e,arguments)}),e._instrumentTryCatch(),e._globalOptions.autoBreadcrumbs&&e._instrumentBreadcrumbs(),e._drainPlugins(),e._isRavenInstalled=!0),Error.stackTraceLimit=e._globalOptions.stackTraceLimit,this},setDSN:function(e){var t=this,n=t._parseDSN(e),r=n.path.lastIndexOf("/"),o=n.path.substr(1,r);t._dsn=e,t._globalKey=n.user,t._globalSecret=n.pass&&n.pass.substr(1),t._globalProject=n.path.substr(r+1),t._globalServer=t._getGlobalServer(n),t._globalEndpoint=t._globalServer+"/"+o+"api/"+t._globalProject+"/store/",this._resetBackoff()},context:function(e,t,n){return a(e)&&(n=t||[],t=e,e=void 0),this.wrap(e,t).apply(this,n)},wrap:function(e,t,n){function r(){var r=[],i=arguments.length,s=!e||e&&e.deep!==!1;for(n&&a(n)&&n.apply(this,arguments);i--;)r[i]=s?o.wrap(e,arguments[i]):arguments[i];try{return t.apply(this,r)}catch(t){throw o._ignoreNextOnError(),o.captureException(t,e),t}}var o=this;if(i(t)&&!a(e))return e;if(a(e)&&(t=e,e=void 0),!a(t))return t;try{if(t.__raven__)return t;if(t.__raven_wrapper__)return t.__raven_wrapper__}catch(e){return t}for(var s in t)f(t,s)&&(r[s]=t[s]);return r.prototype=t.prototype,t.__raven_wrapper__=r,r.__raven__=!0,r.__inner__=t,r},uninstall:function(){return E.report.uninstall(),this._restoreBuiltIns(),Error.stackTraceLimit=this._originalErrorStackTraceLimit,this._isRavenInstalled=!1,this},captureException:function(e,t){if(!C(e))return this.captureMessage(e,l({trimHeadFrames:1,stacktrace:!0},t));this._lastCapturedException=e;try{var n=E.computeStackTrace(e);this._handleStackInfo(n,t)}catch(t){if(e!==t)throw t}return this},captureMessage:function(e,t){if(!this._globalOptions.ignoreErrors.test||!this._globalOptions.ignoreErrors.test(e)){t=t||{};var n=l({message:e+""},t);if(this._globalOptions.stacktrace||t&&t.stacktrace){var r;try{throw new Error(e)}catch(e){r=e}r.name=null,t=l({fingerprint:e,trimHeadFrames:(t.trimHeadFrames||0)+1},t);var o=E.computeStackTrace(r),i=this._prepareFrames(o,t);n.stacktrace={frames:i.reverse()}}return this._send(n),this}},captureBreadcrumb:function(e){
var t=l({timestamp:r()/1e3},e);if(a(this._globalOptions.breadcrumbCallback)){var n=this._globalOptions.breadcrumbCallback(t);if(T(n)&&!u(n))t=n;else if(n===!1)return this}return this._breadcrumbs.push(t),this._breadcrumbs.length>this._globalOptions.maxBreadcrumbs&&this._breadcrumbs.shift(),this},addPlugin:function(e){var t=[].slice.call(arguments,1);return this._plugins.push([e,t]),this._isRavenInstalled&&this._drainPlugins(),this},setUserContext:function(e){return this._globalContext.user=e,this},setExtraContext:function(e){return this._mergeContext("extra",e),this},setTagsContext:function(e){return this._mergeContext("tags",e),this},clearContext:function(){return this._globalContext={},this},getContext:function(){return JSON.parse(x(this._globalContext))},setEnvironment:function(e){return this._globalOptions.environment=e,this},setRelease:function(e){return this._globalOptions.release=e,this},setDataCallback:function(e){var t=this._globalOptions.dataCallback;return this._globalOptions.dataCallback=a(e)?function(n){return e(n,t)}:e,this},setBreadcrumbCallback:function(e){var t=this._globalOptions.breadcrumbCallback;return this._globalOptions.breadcrumbCallback=a(e)?function(n){return e(n,t)}:e,this},setShouldSendCallback:function(e){var t=this._globalOptions.shouldSendCallback;return this._globalOptions.shouldSendCallback=a(e)?function(n){return e(n,t)}:e,this},setTransport:function(e){return this._globalOptions.transport=e,this},lastException:function(){return this._lastCapturedException},lastEventId:function(){return this._lastEventId},isSetup:function(){return!!this._hasJSON&&(!!this._globalServer||(this.ravenNotConfiguredError||(this.ravenNotConfiguredError=!0,this._logDebug("error","Error: Raven has not been configured.")),!1))},afterLoad:function(){var e=I.RavenConfig;e&&this.config(e.dsn,e.config).install()},showReportDialog:function(e){if(A){e=e||{};var t=e.eventId||this.lastEventId();if(!t)throw new S("Missing eventId");var n=e.dsn||this._dsn;if(!n)throw new S("Missing DSN");var r=encodeURIComponent,o="";o+="?eventId="+r(t),o+="&dsn="+r(n);var i=e.user||this._globalContext.user;i&&(i.name&&(o+="&name="+r(i.name)),i.email&&(o+="&email="+r(i.email)));var a=this._getGlobalServer(this._parseDSN(n)),s=A.createElement("script");s.async=!0,s.src=a+"/api/embed/error-page/"+o,(A.head||A.body).appendChild(s)}},_ignoreNextOnError:function(){var e=this;this._ignoreOnError+=1,setTimeout(function(){e._ignoreOnError-=1})},_triggerEvent:function(e,t){var n,r;if(this._hasDocument){t=t||{},e="raven"+e.substr(0,1).toUpperCase()+e.substr(1),A.createEvent?(n=A.createEvent("HTMLEvents"),n.initEvent(e,!0,!0)):(n=A.createEventObject(),n.eventType=e);for(r in t)f(t,r)&&(n[r]=t[r]);if(A.createEvent)A.dispatchEvent(n);else try{A.fireEvent("on"+n.eventType.toLowerCase(),n)}catch(e){}}},_breadcrumbEventHandler:function(e){var t=this;return function(n){if(t._keypressTimeout=null,t._lastCapturedEvent!==n){t._lastCapturedEvent=n;var r;try{r=m(n.target)}catch(e){r="<unknown>"}t.captureBreadcrumb({category:"ui."+e,message:r})}}},_keypressEventHandler:function(){var e=this,t=1e3;return function(n){var r;try{r=n.target}catch(e){return}var o=r&&r.tagName;if(o&&("INPUT"===o||"TEXTAREA"===o||r.isContentEditable)){var i=e._keypressTimeout;i||e._breadcrumbEventHandler("input")(n),clearTimeout(i),e._keypressTimeout=setTimeout(function(){e._keypressTimeout=null},t)}}},_captureUrlChange:function(e,t){var n=_(this._location.href),r=_(t),o=_(e);this._lastHref=t,n.protocol===r.protocol&&n.host===r.host&&(t=r.relative),n.protocol===o.protocol&&n.host===o.host&&(e=o.relative),this.captureBreadcrumb({category:"navigation",data:{to:t,from:e}})},_instrumentTryCatch:function(){function e(e){return function(t,r){for(var o=new Array(arguments.length),i=0;i<o.length;++i)o[i]=arguments[i];var s=o[0];return a(s)&&(o[0]=n.wrap(s)),e.apply?e.apply(this,o):e(o[0],o[1])}}function t(e){var t=I[e]&&I[e].prototype;t&&t.hasOwnProperty&&t.hasOwnProperty("addEventListener")&&(k(t,"addEventListener",function(t){return function(r,i,a,s){try{i&&i.handleEvent&&(i.handleEvent=n.wrap(i.handleEvent))}catch(e){}var u,c,l;return o&&o.dom&&("EventTarget"===e||"Node"===e)&&(c=n._breadcrumbEventHandler("click"),l=n._keypressEventHandler(),u=function(e){if(e){var t;try{t=e.type}catch(e){return}return"click"===t?c(e):"keypress"===t?l(e):void 0}}),t.call(this,r,n.wrap(i,void 0,u),a,s)}},r),k(t,"removeEventListener",function(e){return function(t,n,r,o){try{n=n&&(n.__raven_wrapper__?n.__raven_wrapper__:n)}catch(e){}return e.call(this,t,n,r,o)}},r))}var n=this,r=n._wrappedBuiltIns,o=this._globalOptions.autoBreadcrumbs;k(I,"setTimeout",e,r),k(I,"setInterval",e,r),I.requestAnimationFrame&&k(I,"requestAnimationFrame",function(e){return function(t){return e(n.wrap(t))}},r);for(var i=["EventTarget","Window","Node","ApplicationCache","AudioTrackList","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"],s=0;s<i.length;s++)t(i[s])},_instrumentBreadcrumbs:function(){function e(e,n){e in n&&a(n[e])&&k(n,e,function(e){return t.wrap(e)})}var t=this,n=this._globalOptions.autoBreadcrumbs,r=t._wrappedBuiltIns;if(n.xhr&&"XMLHttpRequest"in I){var o=XMLHttpRequest.prototype;k(o,"open",function(e){return function(n,r){return s(r)&&r.indexOf(t._globalKey)===-1&&(this.__raven_xhr={method:n,url:r,status_code:null}),e.apply(this,arguments)}},r),k(o,"send",function(n){return function(r){function o(){if(i.__raven_xhr&&(1===i.readyState||4===i.readyState)){try{i.__raven_xhr.status_code=i.status}catch(e){}t.captureBreadcrumb({type:"http",category:"xhr",data:i.__raven_xhr})}}for(var i=this,s=["onload","onerror","onprogress"],u=0;u<s.length;u++)e(s[u],i);return"onreadystatechange"in i&&a(i.onreadystatechange)?k(i,"onreadystatechange",function(e){return t.wrap(e,void 0,o)}):i.onreadystatechange=o,n.apply(this,arguments)}},r)}n.xhr&&"fetch"in I&&k(I,"fetch",function(e){return function(n,r){for(var o=new Array(arguments.length),i=0;i<o.length;++i)o[i]=arguments[i];var a="GET";o[1]&&o[1].method&&(a=o[1].method);var s={method:a,url:o[0],status_code:null};return t.captureBreadcrumb({type:"http",category:"fetch",data:s}),e.apply(this,o).then(function(e){return s.status_code=e.status,e})}},r),n.dom&&this._hasDocument&&(A.addEventListener?(A.addEventListener("click",t._breadcrumbEventHandler("click"),!1),A.addEventListener("keypress",t._keypressEventHandler(),!1)):(A.attachEvent("onclick",t._breadcrumbEventHandler("click")),A.attachEvent("onkeypress",t._keypressEventHandler())));var i=I.chrome,u=i&&i.app&&i.app.runtime,l=!u&&I.history&&history.pushState;if(n.location&&l){var h=I.onpopstate;I.onpopstate=function(){var e=t._location.href;if(t._captureUrlChange(t._lastHref,e),h)return h.apply(this,arguments)},k(history,"pushState",function(e){return function(){var n=arguments.length>2?arguments[2]:void 0;return n&&t._captureUrlChange(t._lastHref,n+""),e.apply(this,arguments)}},r)}if(n.console&&"console"in I&&console.log){var f=function(e,n){t.captureBreadcrumb({message:e,level:n.level,category:"console"})};c(["debug","info","warn","error","log"],function(e,t){R(console,t,f)})}},_restoreBuiltIns:function(){for(var e;this._wrappedBuiltIns.length;){e=this._wrappedBuiltIns.shift();var t=e[0],n=e[1],r=e[2];t[n]=r}},_drainPlugins:function(){var e=this;c(this._plugins,function(t,n){var r=n[0],o=n[1];r.apply(e,[e].concat(o))})},_parseDSN:function(e){var t=P.exec(e),n={},r=7;try{for(;r--;)n[j[r]]=t[r]||""}catch(t){throw new S("Invalid DSN: "+e)}if(n.pass&&!this._globalOptions.allowSecretKey)throw new S("Do not specify your secret key in the DSN. See: http://bit.ly/raven-secret-key");return n},_getGlobalServer:function(e){var t="//"+e.host+(e.port?":"+e.port:"");return e.protocol&&(t=e.protocol+":"+t),t},_handleOnErrorStackInfo:function(){this._ignoreOnError||this._handleStackInfo.apply(this,arguments)},_handleStackInfo:function(e,t){var n=this._prepareFrames(e,t);this._triggerEvent("handle",{stackInfo:e,options:t}),this._processException(e.name,e.message,e.url,e.lineno,n,t)},_prepareFrames:function(e,t){var n=this,r=[];if(e.stack&&e.stack.length&&(c(e.stack,function(e,t){var o=n._normalizeFrame(t);o&&r.push(o)}),t&&t.trimHeadFrames))for(var o=0;o<t.trimHeadFrames&&o<r.length;o++)r[o].in_app=!1;return r=r.slice(0,this._globalOptions.stackTraceLimit)},_normalizeFrame:function(e){if(e.url){var t={filename:e.url,lineno:e.line,colno:e.column,function:e.func||"?"};return t.in_app=!(this._globalOptions.includePaths.test&&!this._globalOptions.includePaths.test(t.filename)||/(Raven|TraceKit)\./.test(t.function)||/raven\.(min\.)?js$/.test(t.filename)),t}},_processException:function(e,t,n,r,o,i){var a;if((!this._globalOptions.ignoreErrors.test||!this._globalOptions.ignoreErrors.test(t))&&(t+="",o&&o.length?(n=o[0].filename||n,o.reverse(),a={frames:o}):n&&(a={frames:[{filename:n,lineno:r,in_app:!0}]}),(!this._globalOptions.ignoreUrls.test||!this._globalOptions.ignoreUrls.test(n))&&(!this._globalOptions.whitelistUrls.test||this._globalOptions.whitelistUrls.test(n)))){var s=l({exception:{values:[{type:e,value:t,stacktrace:a}]},culprit:n},i);this._send(s)}},_trimPacket:function(e){var t=this._globalOptions.maxMessageLength;if(e.message&&(e.message=h(e.message,t)),e.exception){var n=e.exception.values[0];n.value=h(n.value,t)}var r=e.request;return r&&(r.url&&(r.url=h(r.url,this._globalOptions.maxUrlLength)),r.Referer&&(r.Referer=h(r.Referer,this._globalOptions.maxUrlLength))),e.breadcrumbs&&e.breadcrumbs.values&&this._trimBreadcrumbs(e.breadcrumbs),e},_trimBreadcrumbs:function(e){for(var t,n,r={to:1,from:1,url:1},o=0;o<e.values.length;o++)if(t=e.values[o],t.hasOwnProperty("data")){n=t.data;for(var i in r)n.hasOwnProperty(i)&&(n[i]=h(n[i],this._globalOptions.maxUrlLength))}},_getHttpData:function(){if(this._hasNavigator||this._hasDocument){var e={};return this._hasNavigator&&D.userAgent&&(e.headers={"User-Agent":navigator.userAgent}),this._hasDocument&&(A.location&&A.location.href&&(e.url=A.location.href),A.referrer&&(e.headers||(e.headers={}),e.headers.Referer=A.referrer)),e}},_resetBackoff:function(){this._backoffDuration=0,this._backoffStart=null},_shouldBackoff:function(){return this._backoffDuration&&r()-this._backoffStart<this._backoffDuration},_isRepeatData:function(e){var t=this._lastData;return!(!t||e.message!==t.message||e.culprit!==t.culprit)&&(e.stacktrace||t.stacktrace?w(e.stacktrace,t.stacktrace):!e.exception&&!t.exception||b(e.exception,t.exception))},_setBackoffState:function(e){if(!this._shouldBackoff()){var t=e.status;if(400===t||401===t||429===t){var n;try{n=e.getResponseHeader("Retry-After"),n=1e3*parseInt(n,10)}catch(e){}this._backoffDuration=n?n:2*this._backoffDuration||1e3,this._backoffStart=r()}}},_send:function(e){var t=this._globalOptions,n={project:this._globalProject,logger:t.logger,platform:"javascript"},o=this._getHttpData();if(o&&(n.request=o),e.trimHeadFrames&&delete e.trimHeadFrames,e=l(n,e),e.tags=l(l({},this._globalContext.tags),e.tags),e.extra=l(l({},this._globalContext.extra),e.extra),e.extra["session:duration"]=r()-this._startTime,this._breadcrumbs&&this._breadcrumbs.length>0&&(e.breadcrumbs={values:[].slice.call(this._breadcrumbs,0)}),u(e.tags)&&delete e.tags,this._globalContext.user&&(e.user=this._globalContext.user),t.environment&&(e.environment=t.environment),t.release&&(e.release=t.release),t.serverName&&(e.server_name=t.serverName),a(t.dataCallback)&&(e=t.dataCallback(e)||e),e&&!u(e)&&(!a(t.shouldSendCallback)||t.shouldSendCallback(e)))return this._shouldBackoff()?void this._logDebug("warn","Raven dropped error due to backoff: ",e):void("number"==typeof t.sampleRate?Math.random()<t.sampleRate&&this._sendProcessedPayload(e):this._sendProcessedPayload(e))},_getUuid:function(){return v()},_sendProcessedPayload:function(e,t){var n=this,r=this._globalOptions;if(this.isSetup()){if(this._lastEventId=e.event_id||(e.event_id=this._getUuid()),e=this._trimPacket(e),!this._globalOptions.allowDuplicates&&this._isRepeatData(e))return void this._logDebug("warn","Raven dropped repeat event: ",e);this._lastData=e,this._logDebug("debug","Raven about to send:",e);var o={sentry_version:"7",sentry_client:"raven-js/"+this.VERSION,sentry_key:this._globalKey};this._globalSecret&&(o.sentry_secret=this._globalSecret);var i=e.exception&&e.exception.values[0];this.captureBreadcrumb({category:"sentry",message:i?(i.type?i.type+": ":"")+i.value:e.message,event_id:e.event_id,level:e.level||"error"});var a=this._globalEndpoint;(r.transport||this._makeRequest).call(this,{url:a,auth:o,data:e,options:r,onSuccess:function(){n._resetBackoff(),n._triggerEvent("success",{data:e,src:a}),t&&t()},onError:function(r){n._logDebug("error","Raven transport failed to send: ",r),r.request&&n._setBackoffState(r.request),n._triggerEvent("failure",{data:e,src:a}),r=r||new Error("Raven send failed (no additional details provided)"),t&&t(r)}})}},_makeRequest:function(e){var t=new XMLHttpRequest,n="withCredentials"in t||"undefined"!=typeof XDomainRequest;if(n){var r=e.url;"withCredentials"in t?t.onreadystatechange=function(){if(4===t.readyState)if(200===t.status)e.onSuccess&&e.onSuccess();else if(e.onError){var n=new Error("Sentry error code: "+t.status);n.request=t,e.onError(n)}}:(t=new XDomainRequest,r=r.replace(/^https?:/,""),e.onSuccess&&(t.onload=e.onSuccess),e.onError&&(t.onerror=function(){var n=new Error("Sentry error code: XDomainRequest");n.request=t,e.onError(n)})),t.open("POST",r+"?"+p(e.auth)),t.send(x(e.data))}},_logDebug:function(e){this._originalConsoleMethods[e]&&this.debug&&Function.prototype.apply.call(this._originalConsoleMethods[e],this._originalConsole,[].slice.call(arguments,1))},_mergeContext:function(e,t){i(t)?delete this._globalContext[e]:this._globalContext[e]=l(this._globalContext[e]||{},t)}};var M=Object.prototype;"undefined"!=typeof __DEV__&&__DEV__&&(o.utils={isUndefined:i,isFunction:a,isString:s,isObject:T,isEmptyObject:u,isError:C,each:c,objectMerge:l,truncate:h,hasKey:f,joinRegExp:d,urlencode:p,uuid4:v,htmlTreeAsString:m,htmlElementAsString:g,parseUrl:_,fill:k}),o.prototype.setUser=o.prototype.setUserContext,o.prototype.setReleaseContext=o.prototype.setRelease,e.exports=o}).call(t,function(){return this}())},function(e,t,n){(function(t){"use strict";function r(){return"undefined"==typeof document||"undefined"==typeof document.location?"":document.location.href}var o=n(8),i={collectWindowErrors:!0,debug:!1},a="undefined"!=typeof window?window:"undefined"!=typeof t?t:"undefined"!=typeof self?self:{},s=[].slice,u="?",c=/^(?:[Uu]ncaught (?:exception: )?)?(?:((?:Eval|Internal|Range|Reference|Syntax|Type|URI|)Error): )?(.*)$/;i.report=function(){function e(e){f(),g.push(e)}function t(e){for(var t=g.length-1;t>=0;--t)g[t]===e&&g.splice(t,1)}function n(){d(),g=[]}function l(e,t){var n=null;if(!t||i.collectWindowErrors){for(var r in g)if(g.hasOwnProperty(r))try{g[r].apply(null,[e].concat(s.call(arguments,2)))}catch(e){n=e}if(n)throw n}}function h(e,t,n,a,s){var h=null;if(w)i.computeStackTrace.augmentStackTraceWithInitialElement(w,t,n,e),p();else if(s&&o.isError(s))h=i.computeStackTrace(s),l(h,!0);else{var f,d={url:t,line:n,column:a},_=void 0,m=e;if("[object String]"==={}.toString.call(e)){var f=e.match(c);f&&(_=f[1],m=f[2])}d.func=u,h={name:_,message:m,url:r(),stack:[d]},l(h,!0)}return!!v&&v.apply(this,arguments)}function f(){m||(v=a.onerror,a.onerror=h,m=!0)}function d(){m&&(a.onerror=v,m=!1,v=void 0)}function p(){var e=w,t=y;y=null,w=null,b=null,l.apply(null,[e,!1].concat(t))}function _(e,t){var n=s.call(arguments,1);if(w){if(b===e)return;p()}var r=i.computeStackTrace(e);if(w=r,b=e,y=n,setTimeout(function(){b===e&&p()},r.incomplete?2e3:0),t!==!1)throw e}var v,m,g=[],y=null,b=null,w=null;return _.subscribe=e,_.unsubscribe=t,_.uninstall=n,_}(),i.computeStackTrace=function(){function e(e){if("undefined"!=typeof e.stack&&e.stack){for(var t,n,o,i=/^\s*at (.*?) ?\(((?:file|https?|blob|chrome-extension|native|eval|webpack|<anonymous>|\/).*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,a=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)((?:file|https?|blob|chrome|webpack|resource|\[native).*?)(?::(\d+))?(?::(\d+))?\s*$/i,s=/^\s*at (?:((?:\[object object\])?.+) )?\(?((?:file|ms-appx|https?|webpack|blob):.*?):(\d+)(?::(\d+))?\)?\s*$/i,c=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,l=/\((\S*)(?::(\d+))(?::(\d+))\)/,h=e.stack.split("\n"),f=[],d=(/^(.*) is undefined$/.exec(e.message),0),p=h.length;d<p;++d){if(n=i.exec(h[d])){var _=n[2]&&0===n[2].indexOf("native"),v=n[2]&&0===n[2].indexOf("eval");v&&(t=l.exec(n[2]))&&(n[2]=t[1],n[3]=t[2],n[4]=t[3]),o={url:_?null:n[2],func:n[1]||u,args:_?[n[2]]:[],line:n[3]?+n[3]:null,column:n[4]?+n[4]:null}}else if(n=s.exec(h[d]))o={url:n[2],func:n[1]||u,args:[],line:+n[3],column:n[4]?+n[4]:null};else{if(!(n=a.exec(h[d])))continue;var v=n[3]&&n[3].indexOf(" > eval")>-1;v&&(t=c.exec(n[3]))?(n[3]=t[1],n[4]=t[2],n[5]=null):0!==d||n[5]||"undefined"==typeof e.columnNumber||(f[0].column=e.columnNumber+1),o={url:n[3],func:n[1]||u,args:n[2]?n[2].split(","):[],line:n[4]?+n[4]:null,column:n[5]?+n[5]:null}}!o.func&&o.line&&(o.func=u),f.push(o)}return f.length?{name:e.name,message:e.message,url:r(),stack:f}:null}}function t(e,t,n,r){var o={url:t,line:n};if(o.url&&o.line){if(e.incomplete=!1,o.func||(o.func=u),e.stack.length>0&&e.stack[0].url===o.url){if(e.stack[0].line===o.line)return!1;if(!e.stack[0].line&&e.stack[0].func===o.func)return e.stack[0].line=o.line,!1}return e.stack.unshift(o),e.partial=!0,!0}return e.incomplete=!0,!1}function n(e,a){for(var s,c,l=/function\s+([_$a-zA-Z\xA0-\uFFFF][_$a-zA-Z0-9\xA0-\uFFFF]*)?\s*\(/i,h=[],f={},d=!1,p=n.caller;p&&!d;p=p.caller)if(p!==o&&p!==i.report){if(c={url:null,func:u,line:null,column:null},p.name?c.func=p.name:(s=l.exec(p.toString()))&&(c.func=s[1]),"undefined"==typeof c.func)try{c.func=s.input.substring(0,s.input.indexOf("{"))}catch(e){}f[""+p]?d=!0:f[""+p]=!0,h.push(c)}a&&h.splice(0,a);var _={name:e.name,message:e.message,url:r(),stack:h};return t(_,e.sourceURL||e.fileName,e.line||e.lineNumber,e.message||e.description),_}function o(t,o){var a=null;o=null==o?0:+o;try{if(a=e(t))return a}catch(e){if(i.debug)throw e}try{if(a=n(t,o+1))return a}catch(e){if(i.debug)throw e}return{name:t.name,message:t.message,url:r()}}return o.augmentStackTraceWithInitialElement=t,o.computeStackTraceFromStackProp=e,o}(),e.exports=i}).call(t,function(){return this}())},function(e,t){"use strict";function n(e){return"object"==typeof e&&null!==e}function r(e){var t={}.toString.call(e);return n(e)&&"[object Error]"===t||"[object Exception]"===t||e instanceof Error}e.exports={isObject:n,isError:r}},function(e,t){"use strict";function n(e,t){for(var n=0;n<e.length;++n)if(e[n]===t)return n;return-1}function r(e,t,n,r){return JSON.stringify(e,o(t,r),n)}function o(e,t){var r=[],o=[];return null==t&&(t=function(e,t){return r[0]===t?"[Circular ~]":"[Circular ~."+o.slice(0,n(r,t)).join(".")+"]"}),function(i,a){if(r.length>0){var s=n(r,this);~s?r.splice(s+1):r.push(this),~s?o.splice(s,1/0,i):o.push(i),~n(r,a)&&(a=t.call(this,i,a))}else r.push(a);return null==e?a:e.call(this,i,a)}}t=e.exports=r,t.getSerialize=o},function(e,t){"use strict";function n(e){this.name="RavenConfigError",this.message=e}n.prototype=new Error,n.prototype.constructor=n,e.exports=n},function(e,t){"use strict";var n=function(e,t,n){var r=e[t],o=e;if(t in e){var i="warn"===t?"warning":t;e[t]=function(){var e=[].slice.call(arguments),t=""+e.join(" "),a={level:i,logger:"console",extra:{arguments:e}};n&&n(t,a),r&&Function.prototype.apply.call(r,o,e)}}};e.exports={wrapMethod:n}},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(t){n(this,e);var r=this;r.userAgent=t;var o=e._uamatch(t);if(o.browser&&(r[o.browser]=!0,r.name=o.browser,r.version=o.version),r.chrome?r.webkit=!0:r.webkit&&(r.safari=!0),r.iPad="iPad"===t.match(/iPad/),r.iPod="iPod"===t.match(/iPod/),r.iPhone="iPhone"===t.match(/iPhone/),r.blackberry="BlackBerry"===t.match("/BlackBerry/")&&r.webkit===!0,r.palmPre="webOS"===t.match("/webOS/")&&r.webkit===!0,r.mobile=null!==t.match(/iPod|iPad|iPhone|Android|BlackBerry|Opera Mini|Fennec|IEMobile|webOS/i),r.legacyMSIE=r.msie===!0&&r.version<11,r.mapUrl="http://maps.google.com/maps",r.iPad||r.iPod||this.iPhone){var i=t.match(/OS (\d)(_\d)/i);null!==i&&(r.iOSVersion={major:i[1],minor:i[2]},r.iOSVersion.major>5&&(r.mapUrl="http://maps.apple.com/"))}}return r(e,null,[{key:"_uamatch",value:function(e){e=e.toLowerCase();var t=/(chrome)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[];return{browser:t[1]||"",version:t[2]||"0"}}}]),e}();t.default=o},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.FetchResponseDataError=t.FetchAbortError=void 0;var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();n(14);var c=n(15),l=r(c),h=n(16),f=r(h),d=t.FetchAbortError=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Fetch was aborted";o(this,t);var r=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return r.abort=!0,r.response=e,r}return a(t,e),t}(l.default),p=t.FetchResponseDataError=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Response data status error";o(this,t);var r=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return r.data=e,r}return a(t,e),t}(l.default),_=function(){function e(t){o(this,e),this.app=t,this.ongoingFetchPromises=[]}return u(e,[{key:"fetch",value:function(e){function t(t,n){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(t,n){var r=this;n=this._processFetchOptions(n);var o=e.makeAbortable(fetch(t,n));return this._registerFetchPromise(o),o.promise.then(function(e){return r._checkStatus(e)})})},{key:"fetchJson",value:function(t,n){return this.fetch(t,n).then(e.parseJSON)}},{key:"fetchXml",value:function(t,n){return this.fetch(t,n).then(e.parseXML)}},{key:"post",value:function(t,n,r){return r=e.addPostOptions(n,r),this.fetch(t,r)}},{key:"postJson",value:function(t,n,r){return this.post(t,n,r).then(e.parseJSON)}},{key:"_processFetchOptions",value:function(e){var t={credentials:"same-origin"};e=Object.assign({},t,e),e.headers=new Headers(e.headers||{}),e.headers.set("X-Requested-With","XMLHttpRequest");var n=new Headers(this.app.getXSRFHeaders()),r=n.entries(),o=!0,i=!1,a=void 0;try{for(var s,u=r[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value;e.headers.set(c[0],c[1])}}catch(e){i=!0,a=e}finally{try{!o&&u.return&&u.return()}finally{if(i)throw a}}return e}},{key:"abortOngoingFetchPromises",value:function(){for(var e=this.ongoingFetchPromises.pop();"undefined"!=typeof e;)e.abort(),e=this.ongoingFetchPromises.pop()}},{key:"_registerFetchPromise",value:function(e){this.ongoingFetchPromises.push(e)}},{key:"_unregisterFetchPromise",value:function(e){var t=this.ongoingFetchPromises.indexOf(e);t>=0&&this.ongoingFetchPromises.splice(t,1)}},{key:"_checkStatus",value:function(e){var t=this;if("abort"===e.statusText)throw new d(e);if(401===e.status)return this._getViewFromResponse(e).then(function(e){t.app.detectedExpiredSession(e)}).then(function(){throw new d(e)});if(0===e.status)return this._getViewFromResponse(e).then(function(e){t.app.detectedNetworkError(e)}).then(function(){throw new d(e)});if(e.status>=200&&e.status<300)return e;var n=new Error(e.statusText);throw n.response=e,n}},{key:"_getViewFromResponse",value:function(t){return e.parseJSON(t).then(function(e){return!!e.view&&e.view}).catch(function(){return!1})}}],[{key:"parseText",value:function(e){return e.text()}},{key:"parseJSON",value:function(e){return e.json()}},{key:"parseXML",value:function(t){return e.parseText(t).then(function(e){return(new DOMParser).parseFromString(e,"text/xml")})}},{key:"handleApplicationResponseData",value:function(e){var t=e.status;if("undefined"!=typeof e.data&&(e=e.data,e.status&&(t=e.status)),"error"===t)throw new p(e);return e}},{key:"makeAbortable",value:function(e){var t=!1,n=new Promise(function(n,r){e.then(function(e){return t?r(new d(e)):n(e)},function(e){return r(t?new d(e):e)})});return{promise:n,abort:function(){t=!0}}}},{key:"addPostOptions",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.method="POST",t.headers=new Headers(t.headers||{}),"string"==typeof e?t.headers.has("Content-type")||t.headers.set("Content-type","application/x-www-form-urlencoded;charset=UTF-8"):"object"===("undefined"==typeof e?"undefined":s(e))&&(e instanceof URLSearchParams||e instanceof FormData||(e=new URLSearchParams((0,f.default)(e)))),t.body=e,t}}]),e}();t.default=_},function(e,t){!function(e){"use strict";function t(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function n(e){return"string"!=typeof e&&(e=String(e)),e}function r(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return m.iterable&&(t[Symbol.iterator]=function(){return t}),t}function o(e){this.map={},e instanceof o?e.forEach(function(e,t){this.append(t,e)},this):Array.isArray(e)?e.forEach(function(e){this.append(e[0],e[1])},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}function i(e){return e.bodyUsed?Promise.reject(new TypeError("Already read")):void(e.bodyUsed=!0)}function a(e){return new Promise(function(t,n){e.onload=function(){t(e.result)},e.onerror=function(){n(e.error)}})}function s(e){var t=new FileReader,n=a(t);return t.readAsArrayBuffer(e),n}function u(e){var t=new FileReader,n=a(t);return t.readAsText(e),n}function c(e){for(var t=new Uint8Array(e),n=new Array(t.length),r=0;r<t.length;r++)n[r]=String.fromCharCode(t[r]);return n.join("")}function l(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function h(){return this.bodyUsed=!1,this._initBody=function(e){if(this._bodyInit=e,e)if("string"==typeof e)this._bodyText=e;else if(m.blob&&Blob.prototype.isPrototypeOf(e))this._bodyBlob=e;else if(m.formData&&FormData.prototype.isPrototypeOf(e))this._bodyFormData=e;else if(m.searchParams&&URLSearchParams.prototype.isPrototypeOf(e))this._bodyText=e.toString();else if(m.arrayBuffer&&m.blob&&y(e))this._bodyArrayBuffer=l(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!m.arrayBuffer||!ArrayBuffer.prototype.isPrototypeOf(e)&&!b(e))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=l(e)}else this._bodyText="";this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):m.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},m.blob&&(this.blob=function(){var e=i(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?i(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(s)}),this.text=function(){var e=i(this);if(e)return e;if(this._bodyBlob)return u(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(c(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},m.formData&&(this.formData=function(){return this.text().then(p)}),this.json=function(){return this.text().then(JSON.parse)},this}function f(e){var t=e.toUpperCase();return w.indexOf(t)>-1?t:e}function d(e,t){t=t||{};var n=t.body;if(e instanceof d){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new o(e.headers)),this.method=e.method,this.mode=e.mode,n||null==e._bodyInit||(n=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"omit",!t.headers&&this.headers||(this.headers=new o(t.headers)),this.method=f(t.method||this.method||"GET"),this.mode=t.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&n)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(n)}function p(e){var t=new FormData;return e.trim().split("&").forEach(function(e){if(e){var n=e.split("="),r=n.shift().replace(/\+/g," "),o=n.join("=").replace(/\+/g," ");t.append(decodeURIComponent(r),decodeURIComponent(o))}}),t}function _(e){var t=new o;return e.split(/\r?\n/).forEach(function(e){var n=e.split(":"),r=n.shift().trim();if(r){var o=n.join(":").trim();t.append(r,o)}}),t}function v(e,t){t||(t={}),this.type="default",this.status="status"in t?t.status:200,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new o(t.headers),this.url=t.url||"",this._initBody(e)}if(!e.fetch){var m={searchParams:"URLSearchParams"in e,iterable:"Symbol"in e&&"iterator"in Symbol,blob:"FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch(e){return!1}}(),formData:"FormData"in e,arrayBuffer:"ArrayBuffer"in e};if(m.arrayBuffer)var g=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],y=function(e){return e&&DataView.prototype.isPrototypeOf(e)},b=ArrayBuffer.isView||function(e){return e&&g.indexOf(Object.prototype.toString.call(e))>-1};o.prototype.append=function(e,r){e=t(e),r=n(r);var o=this.map[e];this.map[e]=o?o+","+r:r},o.prototype.delete=function(e){delete this.map[t(e)]},o.prototype.get=function(e){return e=t(e),this.has(e)?this.map[e]:null},o.prototype.has=function(e){return this.map.hasOwnProperty(t(e))},o.prototype.set=function(e,r){this.map[t(e)]=n(r)},o.prototype.forEach=function(e,t){for(var n in this.map)this.map.hasOwnProperty(n)&&e.call(t,this.map[n],n,this);
},o.prototype.keys=function(){var e=[];return this.forEach(function(t,n){e.push(n)}),r(e)},o.prototype.values=function(){var e=[];return this.forEach(function(t){e.push(t)}),r(e)},o.prototype.entries=function(){var e=[];return this.forEach(function(t,n){e.push([n,t])}),r(e)},m.iterable&&(o.prototype[Symbol.iterator]=o.prototype.entries);var w=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];d.prototype.clone=function(){return new d(this,{body:this._bodyInit})},h.call(d.prototype),h.call(v.prototype),v.prototype.clone=function(){return new v(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new o(this.headers),url:this.url})},v.error=function(){var e=new v(null,{status:0,statusText:""});return e.type="error",e};var k=[301,302,303,307,308];v.redirect=function(e,t){if(k.indexOf(t)===-1)throw new RangeError("Invalid status code");return new v(null,{status:t,headers:{location:e}})},e.Headers=o,e.Request=d,e.Response=v,e.fetch=function(e,t){return new Promise(function(n,r){var o=new d(e,t),i=new XMLHttpRequest;i.onload=function(){var e={status:i.status,statusText:i.statusText,headers:_(i.getAllResponseHeaders()||"")};e.url="responseURL"in i?i.responseURL:e.headers.get("X-Request-URL");var t="response"in i?i.response:i.responseText;n(new v(t,e))},i.onerror=function(){r(new TypeError("Network request failed"))},i.ontimeout=function(){r(new TypeError("Network request failed"))},i.open(o.method,o.url,!0),"include"===o.credentials&&(i.withCredentials=!0),"responseType"in i&&m.blob&&(i.responseType="blob"),o.headers.forEach(function(e,t){i.setRequestHeader(t,e)}),i.send("undefined"==typeof o._bodyInit?null:o._bodyInit)})},e.fetch.polyfill=!0}}("undefined"!=typeof self?self:this)},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function i(e){function t(){e.apply(this,arguments)}return t.prototype=Object.create(e.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e,t}Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";n(this,t);var o=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return Object.defineProperty(o,"message",{configurable:!0,enumerable:!1,value:e,writable:!0}),Object.defineProperty(o,"name",{configurable:!0,enumerable:!1,value:o.constructor.name,writable:!0}),Error.hasOwnProperty("captureStackTrace")?(Error.captureStackTrace(o,o.constructor),r(o)):(Object.defineProperty(o,"stack",{configurable:!0,enumerable:!1,value:new Error(e).stack,writable:!0}),o)}return o(t,e),t}(i(Error));t.default=a,e.exports=t.default},function(e,t,n){var r,o;/**
	 * @preserve jquery-param (c) 2015 KNOWLEDGECODE | MIT
	 */
!function(n){"use strict";var i=function(e){var t=[],n=/\[\]$/,r=function(e){return"[object Array]"===Object.prototype.toString.call(e)},o=function(e,n){n="function"==typeof n?n():null===n?"":void 0===n?"":n,t[t.length]=encodeURIComponent(e)+"="+encodeURIComponent(n)},i=function(e,a){var s,u,c;if(e)if(r(a))for(s=0,u=a.length;s<u;s++)n.test(e)?o(e,a[s]):i(e+"["+("object"==typeof a[s]?s:"")+"]",a[s]);else if(a&&"[object Object]"===String(a))for(c in a)i(e+"["+c+"]",a[c]);else o(e,a);else if(r(a))for(s=0,u=a.length;s<u;s++)o(a[s].name,a[s].value);else for(c in a)i(c,a[c]);return t};return i("",e).join("&").replace(/%20/g,"+")};"object"==typeof e&&"object"==typeof e.exports?e.exports=i:(r=[],o=function(){return i}.apply(t,r),!(void 0!==o&&(e.exports=o)))}(this)},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(4),u=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.app=e,n._view="",n._id=!1,n._uri_params={},n._redrawn=!1,n._loadSteps=[function(e){return n._load(e)}],n.on("hook",function(){$("input").each(function(e,t){$(t).attr("maxlength")||$(t).attr("maxlength",255)})}),n}return i(t,e),a(t,[{key:"changed",value:function(e){}},{key:"parseHash",value:function(e){var t=this.app.parseHash(e),n=t.view.indexOf("/");if(n>0){var r=t.view.indexOf("/",n+1);r>0&&(n=r,t.id=t.view.substr(n+1),t.view=t.view.substr(0,n))}else t.id=!1;return t}},{key:"onHashChange",value:function(e){var t=this.parseHash(e);return this._onHashChange(e,t)}},{key:"_onHashChange",value:function(e,t){return!1}},{key:"onScrollToAnchor",value:function(e,t){e.focus();var n=e.offset();window.scrollTo(n.left,n.top)}},{key:"init",value:function(e){var t=this.parseHash(e);this._uri=t,this._view=t.view,this._id=t.id,this._uri_params=t.params}},{key:"load",value:function(e){var t=this;return this.app.performUnmounts(),this.params=e,Promise.all(this._loadSteps.map(function(t){return t(e)})).then(function(){t.emit("load",e)})}},{key:"_load",value:function(e){}},{key:"addLoadStep",value:function(e){this._loadSteps.push(e)}},{key:"draw",value:function(e){if(this.app.performUnmounts(),this._onBeforeDraw(),this._canRedraw()){for(var t=this._getRedrawingSelectors(),n=!0,r=0;n&&r<t.length;r++)$(t[r]).length||(n=!1);if(t=null,n)return this._redrawn=!0,this.app.debug&&console.debug("Redrawing content"),void this._onDraw(!0)}this._redrawn=!1,this.app.debug&&console.debug("Drawing view"),$("#content").html(e),this._onDraw()}},{key:"_canRedraw",value:function(){return!1}},{key:"_getRedrawingSelectors",value:function(){return[]}},{key:"_onBeforeDraw",value:function(){}},{key:"_onDraw",value:function(e){}},{key:"hook",value:function(e){var t=this;return t._redrawn?Promise.resolve():(t.app.debug&&console.debug("Hooking view"),t.updateReturnToParentView(),Promise.resolve(this._hook(e)).then(function(){t.emit("hook",e)}))}},{key:"_hook",value:function(e){return this.app.debug&&this.app._throw("View does not implement _hook function"),Promise.resolve()}},{key:"inject",value:function(e){return this.app.debug&&console.debug("Injecting model"),this._inject(e)}},{key:"_inject",value:function(e){return this.app.debug&&this.app._throw("View does not implement _inject function"),Promise.resolve()}},{key:"close",value:function(e){var t=this;return Promise.resolve(this._canClose()).then(function(e){return e?(t.emit("close"),{ok:!0}):Promise.resolve(t._onCancelClose()).then(function(){return{cancel:!0}})}).then(function(t){return"function"==typeof e&&e(t),t})}},{key:"_canClose",value:function(){return!0}},{key:"_onCancelClose",value:function(){this.app.debug&&this.app._throw("View does not implement _onCancelClose function")}},{key:"pushParentView",value:function(e){var t=this,n="";return t._uri_params.parent_view&&(n+=t._uri_params.parent_view+"|"),n+=encodeURIComponent(e)}},{key:"popParentView",value:function(e){if("undefined"==typeof e&&(e=!0),void 0===this._uri_params.parent_view)return!1;var t=this._uri_params.parent_view.split("|"),n=decodeURIComponent(t.pop());0===t.length?this._uri_params.parent_view=void 0:this._uri_params.parent_view=t.join("|");var r="";return r=n?e?"#"+n+"/"+this._id:"#"+n:"#",t.length>0&&(r+="&parent_view="+t.join("|")),r}},{key:"getParentView",value:function(){var e=this;if(void 0===e._uri_params.parent_view)return!1;if(""===e._uri_params.parent_view)return e._uri_params.parent_view;var t=e._uri_params.parent_view.split("|");return decodeURIComponent(t.pop())}},{key:"updateReturnToParentView",value:function(){var e=this,t=e.getParentView();if(t){var n="BACK_TO_"+t.toUpperCase().split("/").splice(0,2).join("_"),r=e.app._(n);$(".hook_back_to_parent_view").text(r)}}}]),t}(s.EventEmitter);t.default=u},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},l=n(17),h=r(l),f=n(19),d=r(f),p=n(13),_=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),r=n;return n._can_save=!0,n._modified=!1,n._soft_modified=!1,n._validateSteps=[],n.on("hook",function(){var e=$("#content form");e.on("change",":input[name]:not(.no-form-change)",function(){r.changed(this)}),e.on("keypress",":input[type=text]:not(.no-form-change),:input[type=password]:not(.no-form-change)",function(){r.changed(this)}),$(".number:not(.positive)").number(),$(".number.positive").number({positive:!0}),n._initOnBeforeUnloadEvents()}),n.on("close",function(){$("#edit_form").off("**"),n._restoreOnBeforeUnloadEvents()}),n.on("saveInit",function(e){n._restoreOnBeforeUnloadEvents()}),n.on("saveStart",function(){$("input[type=submit],input[type=button]").prop("disabled",!0),n.app.showOverlay()}),n.on("save",function(e){e.cancel&&n._initOnBeforeUnloadEvents()}),n.on("saveEnd",function(){n.app.hideOverlay(),$("input[type=submit],input[type=button]").prop("disabled",!1)}),n}return a(t,e),u(t,[{key:"changed",value:function(e){this._modified||(this._modified=!0)}},{key:"softModified",value:function(){this._soft_modified||(this._soft_modified=!0)}},{key:"_initOnBeforeUnloadEvents",value:function(){var e=this;this._onBeforeUnloadBackup=window.onbeforeunload;var t=function(t){if("undefined"!=typeof e._onBeforeUnloadBackup&&e._onBeforeUnloadBackup(t),e._modified)return e.app._("SAVE_CHANGES_MESSAGE")};"Microsoft Internet Explorer"===navigator.appName&&$(document).on("mouseenter",'a[href^="javascript:"]',function(){window.onbeforeunload=null}).on("mouseleave",'a[href^="javascript:"]',function(){window.onbeforeunload=t}),window.onbeforeunload=t}},{key:"_restoreOnBeforeUnloadEvents",value:function(){window.onbeforeunload=this._onBeforeUnloadBackup}},{key:"inject",value:function(e){this.app.debug&&console.debug("Injecting model"),this._soft_modified=!1,this._inject(e),this._modified=!1}},{key:"close",value:function(){var e=this;return this._modified&&this._can_save?this.showSaveDialog().then(function(n){return n.cancel?{cancel:!0}:c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"close",e).call(e)}):c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"close",this).call(this)}},{key:"getSaveChangeDialogHtml",value:function(){return'<div class="modal-dialog"><h2>'+this.app._("SAVE_CHANGES_TITLE")+"</h2><p>"+this.app._("SAVE_CHANGES_MESSAGE")+'</p><p class="submit"><a href="javascript:void(0);" id="hook_cancel_save_changes">'+this.app._("CANCEL")+'</a><input type="submit" id="hook_do_not_save_changes" value="'+this.app._("NO")+'" /><input type="submit" id="hook_do_save_changes" value="'+this.app._("YES")+'" /></p></div>'}},{key:"showSaveDialog",value:function(e){var t=new d.default(this);return t.show().then(function(t){return"function"==typeof e&&e(t),t})}},{key:"save",value:function(){var e=this;return this.emit("saveInit"),this._can_save&&(this._modified||this._soft_modified)?Promise.resolve(this.validate()).then(function(t){if(!t)return Promise.resolve({cancel:!0});e.emit("saveStart");var n="&id="+encodeURIComponent(e._id)+e._onSave(),r=e.app.getViewUrl(e._view,"save",n);return e.app.fetchJson(r,{method:"POST",body:new URLSearchParams(e._saveBuildPost())}).then(function(t){if(t||(t={}),!e.handleServerSideValidationErrors(t))return Promise.resolve({cancel:!0});if("error"===t.status)throw new p.FetchResponseDataError(t);return e._modified=!1,Promise.resolve({ok:!0,saved:!0,data:t})}).finally(function(){e.emit("saveEnd")}).then(function(t){return e.emit("save",t),t})}):Promise.resolve({ok:!0})}},{key:"handleServerSideValidationErrors",value:function(e){var t=e.validation_errors;return void 0===t&&(t=e.data?e.data.validation_errors:t),t&&t.length&&$.each(t,function(e,t){$("#"+t.field).hintError(t.message)}),!0}},{key:"showSaveErrorMessage",value:function(){this.app.showError(this.app._("SAVE_ERROR_OCCURED"))}},{key:"_saveBuildPost",value:function(){return"&model="+encodeURIComponent($.toJSON(this.createModel()))}},{key:"validate",value:function(){return this._validateSteps.reduce(function(e,t){return e.then(function(e){return!!e&&t()})},Promise.resolve(!0))}},{key:"addValidateStep",value:function(e){this._validateSteps.push(e)}},{key:"_onSave",value:function(){return""}},{key:"createModel",value:function(){var e=this,t={};return $("form input[name],select[name],textarea[name]").each(function(n,r){var o=$(r).val();"radio"==r.type||"checkbox"==r.type?r.checked&&("on"==o?t[r.name]="YES":t[r.name]=o):$(r).hasClass("money")?t[r.name]=$(r).moneyVal():$(r).hasClass("percent")?t[r.name]=e.app.parseFloat(o.replace("%","")):$(r).hasClass("number")?t[r.name]=e.app.parseFloat(o):t[r.name]=o}),this._onCreateModel&&(t=this._onCreateModel(t)),t=this._removeNullValue(t)}},{key:"_onCreateModel",value:function(e){return e}},{key:"_getRedirectionView",value:function(e,t){return(e||"")+"/View/"+(t||"")}},{key:"alternateCreateModel",value:function(e){var t={},n=function(e){return e.replace("]","")},r=function(e,t){var n={};return n[t]=e,n};for(var o in e)if(e.hasOwnProperty(o)){var i=o.split("[").map(n),a=i.reduceRight(r,e[o]);$.extend(!0,t,a)}return t}},{key:"_removeNullValue",value:function(e){if("object"==("undefined"==typeof e?"undefined":s(e)))for(var t in e)e[t]=this._removeNullValue(e[t]);else e||(e="");return e}}]),t}(h.default);t.default=_},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(t){n(this,e),this.view=t,this.app=t.app}return r(e,[{key:"show",value:function(){var e=this;return this.app.showModalDialog(this.getHtml(),"normal").then(function(t){return e.hookCommands(t)})}},{key:"hookCommands",value:function(e){var t=this;return Promise.race([this.hookDialogButton(e,"#hook_do_save_changes").then(function(){return t.doSave()}),this.hookDialogButton(e,"#hook_do_not_save_changes").then(function(){return t.doNotSave()}),this.hookDialogButton(e,"#hook_cancel_save_changes").then(function(){return t.doCancel()})])}},{key:"hookDialogButton",value:function(e,t){var n=this;return new Promise(function(n){e.find(t).safeClick(n)}).then(function(){return n.app.hideModalDialog("normal")})}},{key:"doSave",value:function(){return this.view.save()}},{key:"doNotSave",value:function(){return Promise.resolve({ok:!0})}},{key:"doCancel",value:function(){return Promise.resolve({cancel:!0})}},{key:"getHtml",value:function(){return this.view.getSaveChangeDialogHtml()}}]),e}();t.default=o},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(3),u=(r(s),function(){function e(t){o(this,e),this.app=t,this._date_regex=new RegExp(/^([1-9]{1}\d{3})-{0,1}([0]{1}[1-9]{1}|[1]{1}[0-2]{1})-{0,1}([0-2]{1}[1-9]{1}|[1-2]{1}[0]{1}|[3]{1}[0-1]{1})(| (\d{2}):(\d{2}):(\d{2})(|\.\d+))$/)}return a(e,[{key:"isDate",value:function(e){var t=this._date_regex.exec(e);return null!=t}},{key:"parse",value:function(e){if(null===e)return!1;if("object"==("undefined"==typeof e?"undefined":i(e))){if("undefined"==typeof e.date)return e;e=e.date}var t=this._date_regex.exec(e);if(null==t)return this.app.debug&&console.debug('Could not parse date "'+e+'"'),!1;var n=new Date;return n.setDate(1),n.setYear(t[1]),n.setMonth(parseInt(t[2],10)-1),n.setDate(t[3]),t[4]?(n.setHours(t[5]),n.setMinutes(t[6]),n.setSeconds(t[7])):(n.setHours("0"),n.setMinutes("0"),n.setSeconds("0")),n}},{key:"format",value:function(e,t){if(e=this.parse(e),!e)return"";if("undefined"==typeof t&&(t="long"),"input"==t)return moment(e).format("YYYY-MM-DD");if("long"==t)return moment(e).format("LL");if("longtime"==t)return moment(e).format("LLL");if("short"==t)return"en"===this.app.lang?moment(e).format("MMMM D"):moment(e).format("D MMMM");if("longabbrmonth"==t)return moment(e).format("ll");if("time"==t){var n="LT";return $.isPlainObject(this.app.config)&&"string"==typeof this.app.config.time_format&&(n="24h"===this.app.config.time_format?"HH:mm":"hh:mm A"),moment(e).format(n)}return"dashboard"==t?"en"===this.app.lang?moment(e).format("dddd, MMMM D"):moment(e).format("dddd, D MMMM"):(this.app.debug&&console.debug('Unknown date format "'+t+'"'),"")}},{key:"getMonthName",value:function(e){"undefined"==typeof e&&0===arguments.length&&(e=moment().month());var t=moment.months(e);return $.isArray(t)?void this.app._throw('Unknown month "'+e+'"'):t}},{key:"getAge",value:function(e,t){return e=this.parse(e),t=this.parse(t)||new Date,e===!1||""===e?"":parseInt(moment(t).diff(e,"years"))}},{key:"getFakeBirthdate",value:function(e){return e=parseInt(e),e?moment().subtract(e,"years").startOf("year").format("YYYY-MM-DD"):""}},{key:"getInsuranceAge",value:function(e){var t=this.parse(e);if(t){var n=this.getAge(e),r=new Date,o=new Date,i=new Date;return r.setMonth(t.getMonth()),r.setDate(t.getDate()),i.setMonth(t.getMonth()),i.setDate(t.getDate()),o<r&&r.setFullYear(r.getFullYear()-1),i.setFullYear(r.getFullYear()+1),Math.abs(o-i)<Math.abs(o-r)&&n++,t=null,r=null,o=null,i=null,n}return 0}},{key:"getYear",value:function(e){return e=this.parse(e),e?moment(e).year():0}}]),e}());t.default=u},function(e,t){"use strict";function n(e){return e.replace(/[^\u0000-\u007e]/g,function(e){return o[e]||e})}Object.defineProperty(t,"__esModule",{value:!0});for(var r=[{base:" ",chars:" "},{base:"0",chars:"߀"},{base:"A",chars:"ⒶＡÀÁÂẦẤẪẨÃĀĂẰẮẴẲȦǠÄǞẢÅǺǍȀȂẠẬẶḀĄȺⱯ"},{base:"AA",chars:"Ꜳ"},{base:"AE",chars:"ÆǼǢ"},{base:"AO",chars:"Ꜵ"},{base:"AU",chars:"Ꜷ"},{base:"AV",chars:"ꜸꜺ"},{base:"AY",chars:"Ꜽ"},{base:"B",chars:"ⒷＢḂḄḆɃƁ"},{base:"C",chars:"ｃⒸＣꜾḈ"},{base:"D",chars:"ⒹＤḊĎḌḐḒḎĐƊƉᴅꝹ"},{base:"Dh",chars:"Ð"},{base:"DZ",chars:"ǱǄ"},{base:"Dz",chars:"ǲǅ"},{base:"E",chars:"ɛⒺＥÈÉÊỀẾỄỂẼĒḔḖĔĖËẺĚȄȆẸỆȨḜĘḘḚƐƎᴇ"},{base:"F",chars:"ꝼⒻＦḞƑꝻ"},{base:"G",chars:"ⒼＧǴĜḠĞĠǦĢǤƓꞠꝽꝾɢ"},{base:"H",chars:"ⒽＨĤḢḦȞḤḨḪĦⱧⱵꞍ"},{base:"I",chars:"ⒾＩÌÍÎĨĪĬİÏḮỈǏȈȊỊĮḬƗ"},{base:"J",chars:"ⒿＪĴɈȷ"},{base:"K",chars:"ⓀＫḰǨḲĶḴƘⱩꝀꝂꝄꞢ"},{base:"L",chars:"ⓁＬĿĹĽḶḸĻḼḺŁȽⱢⱠꝈꝆꞀ"},{base:"LJ",chars:"Ǉ"},{base:"Lj",chars:"ǈ"},{base:"M",chars:"ⓂＭḾṀṂⱮƜϻ"},{base:"N",chars:"ꞤȠⓃＮǸŃÑṄŇṆŅṊṈƝꞐᴎ"},{base:"NJ",chars:"Ǌ"},{base:"Nj",chars:"ǋ"},{base:"O",chars:"ⓄＯÒÓÔỒỐỖỔÕṌȬṎŌṐṒŎȮȰÖȪỎŐǑȌȎƠỜỚỠỞỢỌỘǪǬØǾƆƟꝊꝌ"},{base:"OE",chars:"Œ"},{base:"OI",chars:"Ƣ"},{base:"OO",chars:"Ꝏ"},{base:"OU",chars:"Ȣ"},{base:"P",chars:"ⓅＰṔṖƤⱣꝐꝒꝔ"},{base:"Q",chars:"ⓆＱꝖꝘɊ"},{base:"R",chars:"ⓇＲŔṘŘȐȒṚṜŖṞɌⱤꝚꞦꞂ"},{base:"S",chars:"ⓈＳẞŚṤŜṠŠṦṢṨȘŞⱾꞨꞄ"},{base:"T",chars:"ⓉＴṪŤṬȚŢṰṮŦƬƮȾꞆ"},{base:"Th",chars:"Þ"},{base:"TZ",chars:"Ꜩ"},{base:"U",chars:"ⓊＵÙÚÛŨṸŪṺŬÜǛǗǕǙỦŮŰǓȔȖƯỪỨỮỬỰỤṲŲṶṴɄ"},{base:"V",chars:"ⓋＶṼṾƲꝞɅ"},{base:"VY",chars:"Ꝡ"},{base:"W",chars:"ⓌＷẀẂŴẆẄẈⱲ"},{base:"X",chars:"ⓍＸẊẌ"},{base:"Y",chars:"ⓎＹỲÝŶỸȲẎŸỶỴƳɎỾ"},{base:"Z",chars:"ⓏＺŹẐŻŽẒẔƵȤⱿⱫꝢ"},{base:"a",chars:"ⓐａẚàáâầấẫẩãāăằắẵẳȧǡäǟảåǻǎȁȃạậặḁąⱥɐɑ"},{base:"aa",chars:"ꜳ"},{base:"ae",chars:"æǽǣ"},{base:"ao",chars:"ꜵ"},{base:"au",chars:"ꜷ"},{base:"av",chars:"ꜹꜻ"},{base:"ay",chars:"ꜽ"},{base:"b",chars:"ⓑｂḃḅḇƀƃɓƂ"},{base:"c",chars:"ⓒćĉċčçḉƈȼꜿↄCĆĈĊČÇƇȻ"},{base:"d",chars:"ⓓｄḋďḍḑḓḏđƌɖɗƋᏧԁꞪ"},{base:"dh",chars:"ð"},{base:"dz",chars:"ǳǆ"},{base:"e",chars:"ⓔｅèéêềếễểẽēḕḗĕėëẻěȅȇẹệȩḝęḙḛɇǝ"},{base:"f",chars:"ⓕｆḟƒ"},{base:"ff",chars:"ﬀ"},{base:"fi",chars:"ﬁ"},{base:"fl",chars:"ﬂ"},{base:"ffi",chars:"ﬃ"},{base:"ffl",chars:"ﬄ"},{base:"g",chars:"ⓖｇǵĝḡğġǧģǥɠꞡꝿᵹ"},{base:"h",chars:"ⓗｈĥḣḧȟḥḩḫẖħⱨⱶɥ"},{base:"hv",chars:"ƕ"},{base:"i",chars:"ⓘｉìíîĩīĭïḯỉǐȉȋịįḭɨı"},{base:"j",chars:"ⓙｊĵǰɉ"},{base:"k",chars:"ⓚｋḱǩḳķḵƙⱪꝁꝃꝅꞣ"},{base:"l",chars:"ⓛｌŀĺľḷḹļḽḻſłƚɫⱡꝉꞁꝇɭ"},{base:"lj",chars:"ǉ"},{base:"m",chars:"ⓜｍḿṁṃɱɯ"},{base:"n",chars:"ⓝｎǹńñṅňṇņṋṉƞɲŉꞑꞥлԉ"},{base:"nj",chars:"ǌ"},{base:"o",chars:"ⓞｏòóôồốỗổõṍȭṏōṑṓŏȯȱöȫỏőǒȍȏơờớỡởợọộǫǭøǿꝋꝍɵɔᴑ"},{base:"oe",chars:"œ"},{base:"oi",chars:"ƣ"},{base:"oo",chars:"ꝏ"},{base:"ou",chars:"ȣ"},{base:"p",chars:"ⓟｐṕṗƥᵽꝑꝓꝕρ"},{base:"q",chars:"ⓠｑɋꝗꝙ"},{base:"r",chars:"ⓡｒŕṙřȑȓṛṝŗṟɍɽꝛꞧꞃ"},{base:"s",chars:"ⓢｓśṥŝṡšṧṣṩșşȿꞩꞅẛʂ"},{base:"ss",chars:"ß"},{base:"t",chars:"ⓣｔṫẗťṭțţṱṯŧƭʈⱦꞇ"},{base:"th",chars:"þ"},{base:"tz",chars:"ꜩ"},{base:"u",chars:"ⓤｕùúûũṹūṻŭüǜǘǖǚủůűǔȕȗưừứữửựụṳųṷṵʉ"},{base:"v",chars:"ⓥｖṽṿʋꝟʌ"},{base:"vy",chars:"ꝡ"},{base:"w",chars:"ⓦｗẁẃŵẇẅẘẉⱳ"},{base:"x",chars:"ⓧｘẋẍ"},{base:"y",chars:"ⓨｙỳýŷỹȳẏÿỷẙỵƴɏỿ"},{base:"z",chars:"ⓩｚźẑżžẓẕƶȥɀⱬꝣ"}],o={},i=0;i<r.length;i+=1)for(var a=r[i].chars,s=0;s<a.length;s+=1)o[a[s]]=r[i].base;t.default=n},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(t){n(this,e),this.routes=t}return r(e,[{key:"getClass",value:function(t){var n=this;return new Promise(function(r,o){n.routes.forEach(function(n){e.testRoute(t,n)&&r(n.getClass())}),o('No route match:"'+t+'"')})}}],[{key:"testRoute",value:function(e,t){return!(!t.match||t.match!==e)||!!(t.match instanceof RegExp&&e.match(t.match))}}]),e}();t.default=o},function(e,t){"use strict";function n(e){var t=this;this.options=$.extend({},this.defaults,e),this.options.pollDelay=Math.max(this.options.pollDelay,100),this._ajaxTimeoutId=0,this.retryCount=0,this._reset(),this._onWebSocketUpdate=function(e){t._update(e)},this._onAjaxUpdate=function(e,n,r){t._ajaxTimeoutId=0,t._update(e),(t.isPending()||t.isProcessing())&&t._pollServer()},this._onAjaxError=function(e){t._ajaxTimeoutId=0,t.inError=!0,t._notifyError(e.status,e.responseText)},this._ajaxUpdate=function(){$.ajax(t.queueUrl,{contentType:"application/json",error:t._onAjaxError,success:t._onAjaxUpdate})}}Object.defineProperty(t,"__esModule",{value:!0}),n.prototype={defaults:{url:"",postData:!1,update:!1,error:!1,success:!1,cancel:!1,pollDelay:500,websocket:!1},_reset:function(){this.lastStatus={status:"pending",percentage:0,current:0,steps:0},this.started=!1,this.inError=!1,this.cancelled=!1,this.queueUrl=!1,this.result=!1,this.websocket_channel=!1},getStatus:function(){return this.lastStatus.status},isCompleted:function(){return"completed"==this.lastStatus.status},isPending:function(){return"pending"==this.lastStatus.status},isProcessing:function(){return"processing"==this.lastStatus.status},isCancelled:function(){return this.cancelled},isInError:function(){return this.inError},getPercentage:function(){return this.lastStatus.percentage},getCurrentStep:function(){return this.lastStatus.current_step},getStepCount:function(){return this.lastStatus.step_count},getResult:function(){return this.result},cancel:function(){return!(!this.isPending()&&!this.isProcessing())&&(this.options.websocket?this.sendWebSocketCancel():this._ajaxCancel(),!0)},_ajaxCancel:function(){clearTimeout(this._ajaxTimeoutId),this._ajaxTimeoutId=0,this.cancelled=!0;var e=this;$.ajax(this.queueUrl,{type:"DELETE",error:this._onAjaxError,success:function(t){$.isFunction(e.options.cancel)&&e.options.cancel.call({},this)}})},retry:function(){return!(!this.isCompleted()&&!this.isInError())&&(this.retryCount++,this._reset(),this.start(),!0)},getRetryCount:function(){return this.retryCount},start:function(){if(this.started)return!1;this.started=!0;var e={Accept:"poll"+(this.options.websocket?", websocket":"")};this.options.websocket&&(e["X-WebSocket-Token"]=this.options.websocket.getToken());var t="GET";this.options.postData&&(t="POST");var n=this;return $.ajax(this.options.url,{type:t,data:this.options.postData,error:this._onAjaxError,headers:e,success:function(e,t,r){202==r.status?(n.queueUrl=e.data.location,n.options.websocket&&e.data.websocket_channel?(n.websocket_channel=e.data.websocket_channel,n.options.websocket.on(n.websocket_channel,n._onWebSocketUpdate)):n._pollServer()):n._notifyError(r.status,r.responseText)}}),!0},_pollServer:function(){this._ajaxTimeoutId=setTimeout(this._ajaxUpdate,this.options.pollDelay)},_update:function(e){if((this.isPending()||this.isProcessing())&&this._statusChanged(e))switch(this.lastStatus=e,e.status){case"pending":case"processing":$.isFunction(this.options.update)&&this.options.update.call({},this,e.status,e.data.percentage,e.data.current_step,e.data.step_count);break;case"completed":$.isFunction(this.options.success)&&this.options.success.call({},this,e.data.location,e.data.expire_on),this._close();break;case"cancelled":this.cancelled=!0,$.isFunction(this.options.cancel)&&this.options.cancel.call({},this),this._close();break;case"error":this.inError=!0,this._notifyError(500,"");break;default:console.debug("Unknown task status : ".statusUpdate.status)}},_statusChanged:function(e){return!this.lastStatus||!this.lastStatus.data||this.lastStatus.status!=e.status||this.lastStatus.data.percentage!=e.data.percentage||this.lastStatus.data.current!=e.data.current},_close:function(){this.options.websocket&&this.websocket_channel&&(this.options.websocket.off(this.websocket_channel,this._onWebSocketUpdate),this.websocket_channel=!1)},_notifyError:function(e,t){$.isFunction(this.options.error)&&this.options.error.call({},this,e,t)}},t.default=n}]);